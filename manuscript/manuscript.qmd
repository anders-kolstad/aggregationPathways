---
title: On the spatial aggregation of ecosystem condition indicators
author:
  - name: Anders Lorentzen Kolstad
    email: anders.kolstad@nina.no
    orchid: https://orcid.org/0000-0002-9623-9491
    affiliations: 
        - id: nina
          name: Norwegian Institute for Nature Research
          department: Department of Terrestrial Ecology
          address: Pb 5685 Torgarden
          city: Trondheim
          postal-code: 7485
    attributes:
        corresponding: true
  - name: Hanno Sandvik
    email: hanno.sandvik@nina.no
    orchid: https://orcid.org/0000-0002-5889-1606
    affiliations:
      - ref: nina
  - name: Bálint Czúcz
    email: balint.czucz@nina.no
    affiliations:
      - ref: nina
abstract: |
  Ecosystem condition accounts (ECA) make use of variables and indicators to describe key ecosystem characteristics, reflecting their condition and deviations from a reference condition. These metrics are often spatially aggregated to represent larger areas, such as countries. However, spatial aggregation of information has the potential to alter the descriptive and normative interpretations one can make from these metrics. For example, aggregation displacement causes the information held in variables and indicators to diverge when these are aggregated spatially. This process is influenced also by the order of steps involved in normalising and aggregating variables. This paper outlines the consequences of different aggregation pathways, emphasising their impact on the credibility of ECAs, and how these are interpreted by users. We introduce a standardised terminology for aggregation pathways specific to ecosystem condition indicators following the SEEA EA standard and provide recommendations for selecting appropriate pathways in various contexts. Our discussion of this topic is aimed at raising the general awareness of spatial aggregation issues and to guide indicator developers in choosing and reporting spatial aggregation methods.  
  
keywords: 
  - SEEA EA
  - ecosystem condition
  - ecosystem accounting
  - indicators
  - aggregation bias
  - aggregation error
  - aggregation displacement
  - upscaling
date: last-modified
bibliography: bibliography.bib
format:
  elsevier-pdf:
    keep-tex: true
    journal:
      name: ---
      formatting: preprint
      model: 3p
      cite-style: authoryear
    include-in-header:
      text: '\usepackage{lineno}\linenumbers'
execute:
  cache: false
  warning: false
  message: false
editor: 
  markdown: 
    wrap: sentence
callout-appearance: simple
callout-icon: false
---

```{r setup, include=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
```

# Introduction

The world is facing a nature crisis of a magnitude that requires urgent political decision making and international coordination [@ipbes_global_2019].
Ecosystem accounting (EA) is a type of environmental assessments aimed at communicating on the status and trends in the extent and condition of ecosystems at a scale and in a format that is relevant for decision makers [@edens2022, @comte2022].
For ecosystem condition accounting (ECA) and assessments, this often requires that metrics[^1] used to describe the condition of ecosystems are aggregated spatially to produce a single value for a larger area.
This represents a type of knowledge synthesis, aimed at condensing the complexity of the real world into something that is relevant to decision makers and perhaps actionable at a political level [@king2024] <!--# read more -->.
However, spatial aggregation affect how a metric should be interpreted, and the descriptive properties and normative claims one can make based on it [@allain2018], and without an understanding of the pitfalls during spatial aggregation of information, one risks introducing unintended and undetected systematic bias, as well as downright logical errors, into the decision making process.

[^1]: We use the SEEA EA definitions of the terms variables, indicators (normalised variables) and metrics (refering to either a variable or a metric) [@unitednations2024]

Although much attention has been devoted to the vertical aggregation of environmental indicators into indices [e.g. @langhans2014; @maes2020; @oecd_2008], as well as to the spatial aggregation of relatively unmodified or raw variables [e.g. @allain2018], there is to our knowledge no explicit deliberation on the special case of spatially aggregating highly modified indicators used for ecosystem condition accounting [but see @vanbeurden1999].
This paper therefore focus on explaining and providing guidelines on the spatial aggregation inherent to the System of Environmental Economic Accounting - Ecosystem Accounting (SEEA EA) [@unitednations2024] - the most used ecosystem accounting framework in the world [@comte2022].

SEEA EA includes principles for compiling accounts for ecosystem extent, ecosystem condition, and ecosystem services [@unitednations2024; -@unitednations2022].
We will focus on the SEEA EA condition accounts in this paper, although spatial aggregation is a relevant topic also for the other parts of the account, and to other types of indicator-based ecosystem assessments.
When EU and EEA countries are in 2026 required to report ecosystem condition accounts to Eurostat and the European Commision (?), these accounts will be spatially aggregated to national levels.
The point of having a robust methodological framework for the spatial aggregation of data and information is therefore quite pertinent.
<!--# thus invoking the issue of the ecological fallacy (Box 1), and many other potential pitfalls in the spatial aggregation of information. -->

This paper is aimed primarily at indicator developers, providing them with some recommendations for how to choose the right spatial aggregation approach for variables and indicators, and how to report these choices.
Indicator developer subjectivity affects indicator interpretation [@allain2018] and finally the conclusion from ECAs.
Still, the process of designing indicators and estimating indicator values often left entirely to the them, with little real involvement from indicator users.
It is therefore important to be aware of the role that indicator developers have in shaping the type of information, and the narratives, that is presented to decision makers.
This paper will make it easier for indicator developers to avoid some of the pitfalls from having a too casual approach to the choice of aggregation pathways.
We use four examples to illustrate some of our main points (@tbl-examples).
In @sec-pathways we describe a new reporting terminology for spatial aggregation pathways.
And finally, in @sec-rec we give four concrete recommendations aimed at indicator developers that will help ensure a sensible and informed approach to spatial scaling of ecosystem condition metrics.

## Terminology

There is a jungle of terms used for similar metrics or operations across relevant theoretical frameworks for ecosystem assessments, such as the SEEA EA, WFD, MSFD, IBECA, OSPAR, PAEC, HD, CFP, and others.
We see a need to a common, more standardised terminology across these fields of practice in order to ease communication and avoid misunderstandings.
For now we will now define the terms and how we use them in this paper.

SEEA EA distinguishes between indicators and variables, as do we.
Variables are metrics describing ecosystem characteristics [@unitednations2024 §5.41].
They are typically either in percentages or fractions, or as raw biophysical units, such as biomass or density.
Indicators on the other hand, are always on a unitless scale between 0 and 1, where 0 represent very poor condition, and 1 represents the very good, or the best possible condition.
Sometimes indicators are calculated directly [e.g. @åström], but usually indicators are made by normalising variables based on two or more reference levels [@unitednations2024 §5.60].
Although also variables may have normative properties (due to choices about how they are chosen, defined, aggregated or presented [@allain2018]), the normalisation of variables into indicators makes them explicitly normative by introducing a clear directional interpretation, where increasing values always refer to an increase in condition in the direction of a reference condition.
The information held by the indicator is also different from that of the variable since additional ecological knowledge can be introduced via the reference levels.
The mathematical part of this normalisation contains several steps (@fig-term).
These can be performed simultaneously, but for clarity we discuss them as separate steps.
The order of the steps can also change.

Variables can be scaled using a minimum of two reference levels, a lower and an upper, that defines which variable values to be coded as zero (X~0~) and as one (X~100~) on the indicator scale.
Variables can, if needed, truncated to produce a bound indicator scale between 0 and 1.
Sometimes variables are transformed to adjust the indicator scale to reflect potentially nonlinear relationships between the variable and ecosystem condition.
This is commonly done by anchoring specific variable values to predefined class boundaries [@czúcz; @jakobsson_setting_2020], but may also be done without any additional reference levels, for example by using a sigmoid or exponential transformation [@mienna2024].
Finally, the indicator scale can also be divided into discrete fractions, either based on additional reference levels, or some other rule (e.g. equal range for each class).
We refer to this step as categorisation.

```{r fig-term}
#| fig-cap: |
#|   Examples of how important terms are used in this manuscript. Note that the meaning of the terms may differ from how they are used in other fields, such as mathematics. The variable (1), in original units, has a minimum (V~min~) and a maximum value (V~max~), as well as points anchoring it to the indicator scale (reference levels; X~n~). Scaled variables (2) are scaled based on X~0~ and X~100~. Truncation (3) implies assigning the value of 0 to values below X~0~, and the value 1 to value above X~100~. Transformation (4) refers to the non-linear transformation of values within the 0-1 range, as in this piecewise-linear example by mapping X~60~ to 0.6 on the indicator scale. Transformations without anchoring points are also included in this term, such as exponential or sigmoid transformation. Categorisation (5) refers to the creation of discrete bins (here five) where incremental change in uncategorised indicator values within a set of class boundaries is ignored. Although truncation, scaling and categorisation can be seen as types of transformations, we exclude these methods from the definition here. Examples 2-5 are normative (hence the gradient colour scale from red to green) because we assume it has been  declared that one end of the scale represents a good state and the other a poor state. All variables that are treated so that they conform to the definition of indicators in the SEEA EA are said to be normalised. For example, if a truncated variable is assumed to have a linear relationship with the indicator scale, then this variable has been normalised even though it has not been transformed. The term rescale is a synonym to normalise, but we will only use the latter from here on.
#| echo: false
knitr::include_graphics("../img/terminologi.png")
```

# Why do we spatially aggregate data in ecosystem condition accounting

Spatiall aggregation of data refers to the conversion of fine-resolution data into coarser-resolution data, and depending on both the purpose and the nature of the metric, there can be several reasons both for performing and for refraining from spatial aggregation.
Readers are referred to @allain2018 for a more comprehensive review of different reasons for spatially aggregating variables.
As we shall see, there are several requirements in the SEEA EA that make spatial aggregation necessary.
However, spatial aggregation also comes with a whole suite of (sometimes undesirable) side-effects.

Generally, spatial aggregation increases the tangibility of a metric, because it simplifies or compresses the information, sometimes into just a single number (total aggregation).
This is sometimes necessary in ecosystem accounting when information is required at a relatively high administrative level (e.g. nations) and when variables and indicators need to be presented in standardised tables which don't allow for describing a lot of spatial variation.

Sometimes total aggregation of a metric is required for the it to actually fit its purpose and become relevant to what it is designed to describe.
For example, a hypothetical variable "*proportion of total land area above critical nitrogen load",* informed from a spatial map of nitrogen loads, would only make sense if data was aggregated across some defined area.
The reason and need for aggregation may therefore originate in the original idea for the metric.

Data may also be only party aggregated, or the same metric may be presented at different levels of aggregation [@allain2018].
A minimum level of aggregation may be decided based on uncertainties in the data: High spatially resolute data may be imprecise at fine scales, leading to false conclusion and potential miss-use [@lyytimäki2013], but these values seen over a larger area may be assumed to converge on some true value, making spatially aggregated data better suited for communication to users.
Other common arguments for performing spatial aggregation are to ease visualisation and to allow relevant comparisons [@allain2018].
For example, ecosystem condition metrics can be visualised on a map, but when both the the spatial resolution and spatial variation is high, maps become too complex, even unintelligible.
It is therefore common to partially aggregate the data and provide a coarser map where different colours, representing values on the map, become distinguishable from each other.
Similarly, one may chose to aggregate such that the spatial resolution matches some meaningful delineation, notably ecosystem assets in SEEA EA, which makes it possible to easily compare the ecosystem condition between these areas.

Spatial aggregation can have several consequences that may or may not be desirable, such as smoothing out spatial variability, which can mask local patterns and trends.
This smoothing out makes the data and its inherent information less suitable for some use cases, such as depicting spatial variation that can be used to support local land-use planning, for aiding a debate about spatial conflicts or identification of high risk areas [@vanbeurden1999].

Spatial aggregating of ecosystem condition metrics is applied to alleviate issues of spatial auto-correlation.
For example if data is collected opportunistically with sampling sizes varying between areas, then performing partial spatial aggregation to some intermediate sized areas will give equal weight or importance to all areas regardless of how many data points are included in each.
This approach represents a form of post-stratification that is also relevant to process data from hierarchical (e.g. blocked) sampling designs.

| Example | Main illustrating point |
|--------------------------|----------------------------------------------|
| Billbery | Commensurable spatial scales for variable and reference levels (@sec-match) |
| Wolves | Spatial compensation and discrepancy between variable and indicator (@sec-discrep) |
| PTI | Compensation and the order of operations (@sec-pathways) |

: Examples used in this paper, and how they illustrate specific points raised {#tbl-examples}

## Matching the scale of variables and reference levels {#sec-match}

Similar to variables, the reference levels used for normalising variables also have a spatial assignment, which can be different from that of the variable.
For example, variable values may exist for unique 10 × 10 m grid cells, but the reference levels may be created with a different spatial scale in mind, for example municipalities, or they can be uniform across the entire accounting area (e.g. a natural zero).
Variables should not be normalised based on reference levels unless they are at a commensurable spatial scale.
The bilberry example (**Example 1**) shows that sometimes variables need to be spatially aggregated before they can be normalised.

<!--# Let's illustrate this with an example using a hypothetical variable depicting wild animal densities. If the upper reference level (X100) for this variable is given by the assumed (or measured) animal densities under the reference condition, then that reference level needs to be assigned a relevant spatial scale, for example a region where the densities are calculated over. One will probably acknowledge the fact that animals move and distribute themselves non-randomly within these regions, and it therefore makes little sense to normalise the variable at a finer scale than region. Doing so would mean that regions perfectly aligned with the reference condition (in terms of animal densities with the region) will show as having sub-regions with sub-optimal condition, simply due to natural variation in where the animals are at any give time. Averaging (arguably the most common spatial aggregation function) the indicator values across sub-regions would not produce a regional indicator value that shows the region as being perfectly aligned with the reference condition, since truncation of variable values above X100 (assuming X100 > X0) means we are only aggregating the negative deviations from the reference level, and that very high animal densities in some sub-regions are not allowed to compensate for low values elsewhere. -->

\clearpage

::: callout-note
**Example 1 -- Billberry**\

*Variable*: Horizontal coverage (vertical projection) of bilberry (*Vaccinum myrtillus*) recorded in permanent vegetation plots.\

*Reference levels*: X~100~ is defined for each ecosystem asset based on an expert elicitation.
Experts were informed by the distribution of the variable values both within and outside protected areas, and the regional distribution of major forest types.
They also used their general knowledge about the effect of forestry and on the general vegetation structure of old-growth forests.
X~0~ is a natural zero (bilberry completely absent).\

| \-                   | Plot 1 | Plot 2 | EA 1         |
|----------------------|--------|--------|--------------|
| **Variable values**  | 2      | 36     | 18           |
| **X~100~**           | 20\*   | 20\*   | 20           |
| **Indicator values** | 0.1\*  | 1.0\*  | 0.9 (0.55\*) |

: Dummy data for the bilberry example. Variable values (% cover of bilberry) is recorded for each vegetation plot, and aggregated (arithmetic mean) to the ecosystem asset (EA) level. The X~100~ value is defined for the EA level, but in this hypothetical case it is also dis-aggregated to each vegetation plot and used for normalising variable values also at the plot level. The dis-aggregated X~100~ values, and subsequent values that rely on these, are marked with an asterisk (\*). {#tbl-billbery}

The bilberry indicator exemplifies different spatial resolutions for the variable and for the reference levels (@tbl-billbery).
The variable is recorded at the scale of vegetation plots.
The reference level however, is designed with a regional spatial scale in mind, especially because of how it encompasses the known variation in forest types in each ecosystem asset to estimate the mean bilberry coverage under the reference condition.
Because the normalisation includes a truncation step, normalisation the variable at the plot scale (pathway 1; @fig-agg1) does not allow overshooting values in plot 2 to compensate for lower values in plot 1 when spatially aggregating the indicator values.
When normalising at the plot scale in this case, one is essentially aggregating only the negative deviations from the upper reference level X~100~, and the aggregated indicator value becomes negatively displaced (0.55) relative to when aggregating variable values (0.9).
Given that X~100~ is defined the way it is, this indicator should follow pathway 3 (@fig-agg1) by spatially aggregating the variable from plot scale to ecosystem asset to allow spatial compensation between plots.
At the scale of ecosystem assets, the variable and the reference levels are at a commensurable scale, and the variable can be normalised and potentially aggregating it further.
:::

## Fitting data to ecosystem assets

In SEEA EA, information about ecosystem condition is made spatially explicit by assigning variable or indicator values to ecosystem assets.
This process requires some spatial manipulations of data, or scale changes [@ewert2011].
The type of manipulation depends on the spatial resolution of the underlying data, as well as the size and configuration of the ecosystem assets.
To elaborate on this issue we first make a distinction between two main types of data: sparse (i.e. spatially incomplete) data and complete data.

<!--# Subsequently, spatial aggregation is required when going from ecosystem assets to large spatial scale, ultimately the scale of the entire ecosystem accounting area (EAA).  -->

Complete, or wall-to-wall data, include remote sensing products, but also other types of pre-aggregated data, where sparse data are assigned to areal units.
This last type of data is very common.
A lot of demographic information for example is made available at the scale of administrative units, rather than at the individual level (which would be very ineffective and problematic also in terms of protecting sensitive information).
Similar pre-aggregation is, however, ambiguous and true for most complete datasets.
Consider as an example data from LiDAR (Light Detection And Ranging).
The raw data is a point cloud, yet the most commonly available datasets are rasters, such as surface or canopy models; wall-to-wall generalisations of the point cloud.
Also data such as satellite images ,or maps derived from such, have some inherent pre-aggregation where values are averaged for each raster cell.
Often there is little we can do, as indicator developers, to affect this pre-aggregation step, but it is important to be aware of it in light of the ecological fallacy (**Box 1**).
This issue will for example affect our ability to detect true maximum or minimum values (used in *worst case* aggregation, for example in the WFD) for the phenomena our variable is describing, since these extremes are already smoothed out in the pre-aggregation step [@vanbeurden1999].
This will clearly affect the suitability of such data for identifying areas of high risk (very degraded areas, for example).
The problem is the same when we deliberately aggregate data later in the indicator development process, and we always need to ensure that the spatial aggregation function we use does not have any unintentional effect on the type of inference that we can draw from the metric.

For sparse data we are considering data where variable values are assigned to singular points or small areas.
In these cases, there will be a lot of area inside each ecosystem asset for which we have no direct information.
To assign variable value to all areas (as is required in the SEEA EA framework), we need to do some generalisations.
One can assign values to areas via an aggregation functions used on data values that fall within a given ecosystem asset.
Many aggregation functions are available, such as sum, worst-rule, different percentiles, arithmetic, geometric or harmonic means[^2] [@unitednations2024 §5.54] .
When doing this aggregation, we need to account for the spatial structure (spatial correlations) of the data.
One way is to rely on design-based approaches (e.g. relying on random or balanced samples across the entire EEA), or using a step-wise aggregation via ecosystem assets or some smaller basal spatial units.
In our experience, the choice of which area units to use when doing this step-wise aggregation is often not reflected much upon.
In some cases the areal units are even decided politically, for example to administrative units, with little ecological justification for this choice.
However, this decision clearly affects the results of the spatial aggregation via a well-described (but often forgotten?) statistical problem referred to at the modifiable area unit problem (MAUP; Box 1).
It is important for decision makers to see that the information they are basing their decision on is robust and insensitive to aggregation methods [@vanbeurden1999].
The MAUP can, however, lead to inconsistencies between repeated or nested ECAs, leading to confusion and mistrust (@sec-comp).
One option to reduce this discrepancy and arbitrariness is to use ecologically motivated areal units in the step-wise aggregation such as homogeneous ecosystem areas [@vallecillo2022] or homogeneous impact areas [@kolstad_making_2024].

[^2]: When using means across areas, area weighting is required when following SEEA EA.

Interpolation, or other types of modeling, can also be used to impute or predict data values between the points where we have information [@finke2002; @stein2001].
This approach can also be seen as a type of post-stratifiction, and it can result in better variable or indicator estimates for the ecosystem assets as a whole.
It can also be motivated by a desire to know more about the fine-scale variation in variable values, and perhaps visualise this on a map.
This type of spatial aggregation, or perhaps better named upscaling, is not the focus of this paper (but see **Box 1**), and in our experience this has not been common practice in SEEA EA accounts produced to date [but see @kolstad_making_2024].

\clearpage

::: callout-note
**Box 1 -- Related concepts**\

**Vertical aggregation**

It is common in the ECA community of practice to use the term aggregation about the process of aggregating normalised indicators into indices (i.e. thematic or vertical aggregation; @langhans2014), but in this paper we are primarily discussing spatial (i.e. horizontal) aggregation.\

**Upscaling**

The term spatial aggregation is also sometimes used to refer to **upscaling** in the sense of taking local information and making it applicable or translate it to larger, e.g. landscape or regional, scales [@knotters2010; @finke2002].
This process often involves predicting values across larger areas or surfaces, generally through models, including krieging-based models and distribution models.
When the data (e.g. indicator values) are made wall-to-wall, one can then more easily get point estimates for larger areas via simple aggregation functions such as summation or by taking the mean.
Using models to predict variable or indicator values is allowed under the SEEA EA. However, in this paper we are addressing the second part of this process only, of simplifying the spatial variation, from many to few data points (sometimes also included in the terms upscaling).\

**Modifiable area unit problem**

The modifiable area unit problem (MAUP) describes the sensitivity of spatially aggregated information to the choice of spatial units used for data collection or aggregation [@openshaw1984, @wong2009].
These units can be arbitrary (*modifiable*), yet different sizes and configuration of units can have large effects on the outcome of aggregation.
Administrative units are often used as the ecosystem assets in SEEA EAs, yet they are in an ecological sense almost always arbitrary, and can also be subject to change over time.
The original spatial units that data are collected at may be a pragmatic choice in much the same way.
Further still, data may not be available at the original spatial scale, but may only be downloadable in preaggregated form [@vanbeurden1999].
All these cases lead to some form of aggregation error[@rastetter1992] where the aggregated information has a non-linear relationship with the true variable value.
However, the issue of MAUP in SEEA EA deserves an in-depth analyses that we cannot provide here.\

**Ecological fallacy**

The ecological fallacy [@robinson2009] explains the common misinterpretation of correlations between groups (*i.e.* aggregated information) and some phenomena.
Simply said, the mean of a group, or an area, cannot accurately describe the qualities of individuals in that group, or pin-points inside that area, yet it is common for people to interpret it that way.
:::

# Why do we normalise variables? {#sec-norm}

Normalisation of ecosystem condition indicators, as defined in @fig-term, serves at least three purposes.
Firstly, it gives a normative interpretation of a variable, defining a good and a bad state, and simultaneously a directionality to say when something is getting better or worse over time [@czucz_selection_2021].
SEEA EA encourages normalisation (which they refer to as rescaling), but other environmental assessment or natural resource accounting frameworks, refrains from these kinds of value judgments, or leaves more of this task up to the end users.
<!-- ref? --> Secondly, normalisation sets a limit to how much a high variable value in one place can compensate for a low value somewhere else, and vice versa [@pedersen2016].
This is because truncation effectively means that when we spatially aggregate an indicator, we are always aggregating the negative deviations from the upper reference level X~100~, and ignoring any positive deviations which would otherwise compensate for the negative ones (see **Example 2**).
Transformation can sometimes also have this effect, e.g. sigmoid transformations.
One reason to want to aggregate the negative deviations only, is because the X~100~ is set (or should be set) so that values above this limit (assuming X~100~ \> X~0~) do not represent any further increase in ecosystem condition (for an exception, see **Example 3**).
Therefore, this way of aggregation summarises the estimated ecosystem condition over an area, and not the variable itself.
In other words, normalising variables facilitate the spatial aggregation of our ecosystem condition estimates (i.e. the indicator values).
The flip-side of this is that spatially aggregating variable values does not directly summarise information about ecosystem condition for that area.

Thirdly, we normalise in order to standardise the indicator on the same scale so that we can perform thematic (i.e. vertical) aggregation [@jakobsson2021; @unitednations2024 §5.81].
This is commonly referred to as *the* reason for normalising variables, but as we have shown, it is but one of three main reasons, and also perhaps the least confusing part for many.

<!--# Try add using !expr to get hat and bar sympols into caption:  -->

```{r fig-agg1}
#| echo: false
#| fig-cap: |
#|   Examples showing the difference in indicator values (y-axis) obtained from taking the mean (V bar) of two variable values (V1 and V1) that are on the original scale (i hat) or on the normalised indicator scale (i bar). Pane A: Due to truncation at X~100~, the latter results in a comparatively lower indicator value. Pane B: Example where the normalisation function includes a transformation step (see Figure 1 for definition) that anchors X~60~ to 0.6 on the indicator scale. This reverses the order of i hat and i bar compared to example in pane A. The solid coloured line represents the normalisation function f(V). V = variable value, i = indicator value. Modified from Rastsetter (1991).
#| out-width: 600

knitr::include_graphics("../img/aggregation_bias.PNG")

```

# Aggregation displacement and spatial compensation {#sec-agg}

The spatial aggregation of data can lead to biases arising from a number of sources.
For example, direct extrapolation based on uneven or spatially biased sampling leads to biased estimates [@kolstad_making_2024].
We will, however, focus now on what we consider an extended case of aggregation error, sensu @rastetter1992.
They showed that when we take the average of two variables, each of which have attribute values (e.g. indicator values) associated with them via some non-linear function, then the attribute of the average variable value differs from the average of the attributes of the original variables.
@rastetter1992 referred to this as aggregation error and used it to describe some of the dangers associated with upscaling in the sense of using precise fine-scale information to explain or predict large scale phenomena.
However, in our case the difference between variables and indicators is an intentional one, and we therefore to refer to what is essentially the same mathematical effect, with the less derogatory term aggregation displacement.

In the statistical standard for EAs and the recommended guidelines for ecosystem accounts [@unitednations2024; -@unitednations2022], there is no mention of aggregation displacement, and there seems to be little awareness in general of the ramification of choosing the wrong spatial aggregation method for variables.
We now describe two ways that aggregation displacement affects ECAs: by causing an increasing divergence in the type of information held in ecosystem condition variables versus indicators (@sec-discrep), and secondly, how it can cause confusion about the effects of choosing different aggregation pathways during indicator development (@sec-develop).

## Discrepancies between variables and indicators {#sec-discrep}

In ecosystem condition accounting the aggregation of both variables and indicators is common practice and raises the issue of aggregation displacement (@fig-agg1) when variables have nonlinear relationships to the normalised indicators [@rastetter1992], which they typically do.
This means that the spatial aggregation of metrics leads to a divergence in the type of information held in variables and in their associated indicators, to a point where they become qualitatively very different.
As an example, consider an indicator based on spatial information on the abundance of a large herbivore.
The ecosystem characteristic that this metric is meant to describe is "*Appropriate herbivore pressure, balancing overgrazing and shrubification"*.
Imagine the variable shows relatively high densities in half the area and low densities in the other half.
When spatially aggregating the variable, either by taking the mean density or the sum of individuals, will produce an estimate that is somewhere in the middle of the two regions.
The user will have no information about the carrying capacity for each of the regions, and will only see the spatially aggregated value.
From this, many different conclusion can be made, depending on what the user consider high or low densities.
In any case, the judgment will not reflect a density that actually exists anywhere.
The indicator on the other hand, can have different reference levels for each region, introducing additional ecological information about the carrying capacity of the ecosystems.
The levels may be such that the high density region is considered as having an overabundance of herbivores, and the low density region as having underabundance.
When normalised, the indicator value will be low for both regions, and the spatially aggregated value will also be low.
The indicator will describe the average condition for the intended ecosystem characteristic, whereas the variable will in essence not show anything that can be interpreted as such.

The wolves example (**Example 2**) also highlight the importance of making clear the differences in the interpretation of variables and indicators.
Indicators and variables are sometimes presented side-by-side in ecosystem condition assessments or accounts.
This is also recommended practice following the SEEA EA [@unitednations2024; ch. 5.3.4].
However, due to aggregation displacement, spatially aggregated indicators should not be interpreted as normalised versions of aggregated variables.
Aggregated indicators reflect the average ecosystem condition, where areas in very good or very poor condition have limited ability to compensate for opposite extreme values elsewhere.
The spatially aggregated variable on the other hand, may reflect something like a sum of individuals, an average of a population, or some other aspect where values above and below the reference levels are able to compensate for each other.

Aggregated variables and the associated aggregated indicators cannot act as alternative evidence or interpretations for the state of nature.
While this may initially seem like a democratic and transparent approach to reporting, this practice places a significant burden on both the end user and the indicator developer.
Miss-use can ensue, for example by taking the variable value and assigning it the same interpretation as the indicator value.
At the very least, the developer must clarify to the user how the two metrics have diverged significantly during spatial aggregation and normalisation, complicating the comparison of their respective information.

::: callout-note
**Example 2 -- Wolves**\

*Variable*: Number of wolves.\

*Reference levels:* X~100~= Number of wolves equal to what experts think the ecosystem would support under the reference condition.
This is number is informed by data on habitat quality, food supply, and more.
X~0~ = no wolves.

|                      | EA 1 | EA 2 | EA 3 | EAA aggregate |
|----------------------|------|------|------|---------------|
| **Variable values**  | 20   | 5    | 0    | Sum = 25      |
| **X~100~**           | 10   | 10   | 5    | Sum = 25      |
| **Indicator values** | 1.0  | 0.5  | 0.0  | Mean = 0.5    |

: Dummy data for the wolves example. EA = ecosystem asset (e.g. a municipality). EAA = ecosystem accounting area (e.g. country). {#tbl-wolf}

This hypothetical example (@tbl-wolf) shows how different the interpretation of a variable and an indicator can become when the information is spatially aggregated.
When species-based indicators are aggregated to the EAA level, it is common for the general public to interpret this value (0.5) as the status for this species, for example the conservation status[^3].
However, for the EAA seen overall, the population size is actually equal to the expected population size in the reference condition.
Instead, the spatially aggregated indicator value describes the ecosystem condition for the different *areas* in terms of wolf under-abundance.
Then we see that the first ecosystem asset have more wolves than than we would expect under the reference condition, whereas the other two have less.
Because variable values above X~100~ are truncated, the high wolf numbers in ecosystem asset one does not compensate for the low indicator value in assets two and three, and hence the mean indicator value is less then the sum of the variable values divided by the sum of the X~100~values.
But the high wolf numbers in asset 1 *does compensate* when looking at the aggregated variable value.

```{=html}
<!-- \*Conclusion\*: Indicators should make intuitive sense to the readers.
However, there are sometimes good reasons for making things complicated. -->
```
:::

[^3]:
    ::: callout-note
    It is sometimes worth going back to the variable, and see if it can be defined differently to avoid this kind of confusions.
    Wolf numbers could in this example be converted to wolf density.
    :::

Generally, because of the normalisation process, indicators are more aligned with the purpose of ECA with describing ecosystem condition in normative terms.
Although variable accounts are allowed under the SEEA EA framework, and is indeed a central feature, we believe they should be seen as interim accounts for metrics that cannot or have not yet been normalised.
We would therefore argue that when an indicator has been developed, the original variable is not presented.
And when only variable estimates are given, extra care is given to describing the spatial aggregation pathway.
Furthermore, Eurostat [@eurostat2022] encourages reporting of variable values.
Sometimes, however, variable values cannot be aggregated spatially in any meaningful way (see **Example 3**).

## Aggregation displacement in indicator development {#sec-develop}

As we have seen, aggregation displacement causes a divergence in the type of information made available through the spatial aggregation of variables versus indicators.
In addition, unavoidable aggregation displacement (for good and bad) will also affect the indicator values and the inferences that can be drawn from these.
If not careful, aggregation displacement may also cause errors to sneak into the indicator logic.
A major determinant of the resulting aggregation displacement from the spatial aggregation of ecosystem condition indicators (@fig-agg1), is the choice about the order of the different steps in the normalisation and aggregation process, i.e. the aggregation pathway (@fig-pathways).
If normalisation occurs early in the aggregation process, the amount of compensation, or off-setting, is limited (**Example 2**).
However, sometimes complete or partial compensation is justified (**Example 1** and **3**).

::: callout-note
**Example 3 -- Phytoplankton trophic index (PTI)**\

*Variable*: Mean score of algal species present, based on a set of indicator species scored for phosphorus requirements/tolerance.
The variable is recorded in water bodies (lakes of 0.5 km^2^ or more).
 

*Reference levels*: X~100~ = median variable value for water bodies in reference condition.
X~0~, X~20~, X~40~, X~60~ and X~80~ = intercalibrated threshold values, based on dose–response curves.\

```{r read}
#| include: false
#| cache: false
dat <- readxl::read_xlsx(here::here("data/PTI_data.xlsx")) |>
  mutate(X = X |> str_replace_all("%", "\\\\%"))
cn <- colnames(dat) |>
    str_replace_all("2", "") |>
    str_replace_all("X", "") |>
    str_replace_all("RL", "X\\\\textsubscript{100}")
```

```{r tbl-pti}
#| echo: false
#| tbl-cap: "Dummy data for the PTI example. value = value for a hypothetical variable. agg. = spatial aggregation (arithemtic mean); trunc. truncation; stat. = spatial statistics. The transformation step is left out for simplicity. Pathways refer to figure 3."
#| cache: false


kbl(dat, format = "latex",
    booktabs = TRUE,
    col.names = cn,
    escape = F
    ) |>
  kable_styling() %>%
  add_header_above(c(
    " " = 3, 
    "Pathway 5" = 4,
     "Pathway 6" = 3)) |>
  collapse_rows(
    columns = c(9,10),
    latex_hline = "major"
  )

```

The Water Framework Directive (WFD) indicators uses aggregation pathway 5 (@fig-pathways), with truncation, scaling, and transformation, in that order (see worked example in @tbl-pti).
The value obtained after the first two steps is called an EQR (ecological quality ratio), and the value obtained after the third step nEQR (normalised EQR).
Spatial aggregation, the way that we use the term here, is not done for the WFD.
Instead, the proportion of water bodies in each condition class is the aggregated reporting metric.
Therefore aggregation displacement is not an issue.
When WFD data are put into use in other contexts, however, aggregation becomes important.

\
Because of how X~100~ is defined based on the median value across reference lakes, overshooting values (\> X~100~) should be preserved in the spatial aggregation.
Otherwise we get a negative displacement, making it practically impossible to reach an indicator value of 1.
This means that neither EQR values, nor nEQR values, can be uncritically aggregated spatially to be used in a SEEA EA compliant in ECA.
One solution, to enable the use of WFD indicators in ECAs, would be to change to pathway 6, with (1) scaling, (2) transforming, (3) aggregating and (4) truncating the values.
In our hypothetical example (@tbl-pti) this gives and aggregated value of 0.85, whereas the mean value for the nEQRs would be 0.75 (i.e. negatively displaced).
:::

# Aggreements across nested ECAs {#sec-comp}

We believe it is a very desirable property that variable and indicator values are comparable across repeated ECAs, and harmonised across assessment scales and so that accounts from sub-areas should be able to recreate the account of the larger area.
This can happen when ECAs use different aggregation pathways for the same indicator.
Cases when two accounts or assessments use what is considered the same metric, but find different values for the same areas, is cause for both confusion, and could result in reduced general credibility for ECAs.

We believe one solution to this is to acknowledge that the aggregation pathway can affect the indicators so much, sometimes as much as variation in the variable itself, that the use of different pathways imply that metrics are named and treated uniquely, for example using different common names, but perhaps better still, different version numbers or indicator IDs.
For each unique indicator the precise aggregation pathway should be specified as part of the indicator metadata.
This would show ECA users if two accounts are using different metrics that cannot be assumed to behave similarly or report the same thing, even if they have the same common name and data source.

SEEA EA uses a the term aggregation commutativity for the property that the order of vertical and horizontal aggregation is irrelevant to the end result.
This is indeed a desirable property, however, when indicators that make up an index have different extents (e.g. they relate to different ecosystem sub-types or have sparse data coverage), then the indicator-specific areal weights will not be transferable in the spatial aggregation of indices (see description of pathways 7 and 8 in @sec-pathways).
A similar commutativity can be envisioned for step-wise aggregation of a single indicator, where it does not matter if the original data is aggregated directly from the original measurement scale to the EAA level, or via some intermittent scale, such as ecosystem assets or larger regions.
This is achievable when aggregating indicators using area weighting, and when one is aware of the need for post-stratification when using stratified data sampling.

# Aggregation pathways {#sec-pathways}

We introduce the term aggregation pathway to describe the order of the steps used to go from a variable at the measurement scale, to a spatially aggregated metric, usually an indicator, that describes the ecosystem condition for a larger area.
In @fig-pathways we show some aggregation pathways that we have come across, and some that we we see as potential new pathways.
The examples are non-exhaustive, and serves mainly to illustrate that many different pathways can be created using a limited number of unique operations (@sec-rec).
We then describe how the aggregation pathways can formally, and succinctly, be described using the names of these operations.
The choice about which pathway to use is not trivial, and we want to highlight some of the issues that could arise from having an *ad hoc* approach to these considerations.

Pathway 1 involves early normalisation using the perhaps most common order of the three steps scaling, truncating and transforming.
The three steps may be done simultaneously or in sequence.
Finanlly, the indicator is spatially aggregated.

Pathway 2 involves aggregating the variable before normalising[^4].
This preserves the ability for very high or very low variable values to compensate for very low or very high values elsewhere, respectively.

[^4]: In a parallel terminology, normalisation can be considered modeling, and spatial aggregation before and after normalisation can be referred to as pre or post processing, respectively [@vanbeurden1999].

Pathway 3 is similar as 2, but here there are two aggregation steps: one before and one after normalisation.
This can for example be the case when variables are aggregated to the scale corresponding to the reference levels before they can be normalised (**Example 1**).

Pathway 4 illustrates the aggregation of a variable, with no normalisation.
This is the pathway commonly used for variable accounts in the SEE EA. For this, and all other aggregation pathways, the picture can be made more complicated by adding additional aggregation levels (i.e. a step-wise aggregation, @sec-comp)

Pathway 5 is a common pathway in the WFD, which does not include spatial aggregation of indicator values.
Instead one report the number of water bodies in each condition class (spatial statistics).
Pathway 6 is a suggested pathway for handling WFD indicator in ECAs (see **Example 3**), where truncation is postponed until after the spatial aggregation for in that way to allow overshooting values to compensate for low indicator values elsewhere (what we refer to as compensation).

Pathways 7-8 describe the spatial aggregation of composite indicators (indices).
These are not the main topic of this paper, but are included here for completeness.
In pathway 7, indicators are thematically aggregated to an index, which is then again aggregated spatially.
The order of the two aggregation steps can be reversed if the process is truly commutative (@sec-comp).
In pathway 8, spatial aggregation is only done on individual indicators.
The two pathways differ in how they handle more complicated schemes for weighted averages.
The spatial aggregation of indices (pathway 7), using area weighted means, does not allow different area weights to be applied to each underlying indicator.
Yet this would in many cases be needed if the individual indicators do not all represents the entire ecosystem inside each ecosystem asset.
This is often the case, since ECA are frequently geared towards high level ecosystem types (e.g. level 2 in the IUCN GET [@keith_iucn_2020]) that includes several lower level ecosystems that may need unique indicators to describe them.
Pathway 8 is therefore more flexible in this regard, but it may interfere with the principle of commutativity [@unitednations2024].
We feel this is a very much unresolved issue in the SEEA EA.

Pathway 9 describe how a single indicators can be aggregated hierarchically from region to region, whereas pathway 10 shows a case were the aggregation process always starts from scratch for each hierarchical spatial level.
As for pathways 7 and 8, pathway 9 and 10 differ in how they propagate the indicator weight (typically area weight) between regions.
SEEA EA describes and prescribes a hierarchical spatial aggregation (pathway 9).
Note that can cause issues with comparability across nested assessment, if one alters the number or size of sub-regions (@sec-comp).

```{r fig-pathways}
#| fig-cap: |
#|   Flowchart showing pathways for the spatial aggregation of variables in ecosystem condition accounting. Normalisation refers to the steps that make a variable conform to the definition of an indicator in SEEA EA, which may include some, but not necesarily all the steps scale, truncate and transform.
#| out-width: 400
#| echo: false
knitr::include_graphics("../img/aggregationPathways.jpg")
```

# Recommendation {#sec-rec}

Based on the above discussion and examples, we here summarise four recommendations for developers of ecosystem condition indicators and assessments for avoiding some of the pitfalls from having a too casual approach to the choice of aggregation pathways.

### 1. Report the aggregation pathway, using standardised terminology {.unnumbered}

ECAs should be accompanied by detailed indicator documentation where a precise description of the steps in the aggregation process is presented.
Verbose descriptions can be supplemented or replaced by a standardised short-hand annotation that we shall present now.
We suggest using the terms as described in @fig-term and elsewhere in the paper: scale, truncate (abbreviated to *trunc.*), transform (*trans.*), spatial aggregation (*sp. agg.*), thematic aggregation (*th. agg.*) and spatial statistics (*sp. stat.*).
These terms can be abbreviated as shown in the parentheses, and placed togeth into a single string, where operations performed simultaneously are enclosed in square brackets.
For example, pathway 1 in @fig-pathways can be annotated as *scale - trunc. - trans. - sp. agg..* If the three normalisation steps are performed simultaneously this can be written as \[*scale - trunc. - trans.\] - sp. agg.* If there are more aggregation steps, then the spatial level at each step should be included in the description, e.g. for pathway 3: *sp. agg. (municipalities) - scale - sp. agg. (country). "*Municipality" and "country" could here be included as footnotes.
Note also that in this example, normalisation only involved a scaling step.
The description of indicator pathways can perhaps made even easier by referencing specific aggregation pathways in @fig-pathways by number, as we have done in this paper.

Besides making the indicator workflow itself more transparent and reproducible, we believe this recommendation would help raise the general awareness about aggregation displacement in EAs, both among users and developers.
It will make the interpretation of ECAs less prone to misunderstanding and miss-use.
It will also make troubleshooting easier, for example when trying to identify the reason why two ECAs produces dissimilar indicator values from the same underlying data.

### 2. Normalise variables early, but at the scale where the reference levels are relevant {.unnumbered}

Normalising variables early in the aggregation pathway means that you are aggregating normative measures of condition, which is generally what you want in ECAs (@sec-norm).
But same as for variables and indicators, reference levels also have a spatial resolution, and they should only be used to normalise variables when the variable is at a scale which is relevant to the way the reference levels are defined, i.e. they are at a commensurable scale (**Example 1**).

### 3. Use a similar aggregation approach for all indicators in the same assessment {.unnumbered}

It may be premature, or not even possible, to prescribe an aggregation pathway to be used for all ECAs, or a type of aggregation pathway to be used given the data at hand.
However, internal consistency within assessments should be possible, and this can make it easier to communicate and interpret the information conveyed though the indicator values.
This can be achieved by for example always scaling early (see recommendation number 2 above) and using the same aggregation levels and same approach to step-wise aggregation across levels (@sec-comp), for all indicators.

### 4. Use unique indicator IDs , also for indicators that are similar, but use different aggregation pathways {.unnumbered}

Indicators (and variables) often exist in multiple versions, varying slightly in the raw data or in the methods used to produce the data or metrics.
Yet different versions are often refereed to by the same common name.
This causes confusion about which indicator version is being used, and thus making it difficult to make out which aggregation pathway that has been used.
We recommend making use of stable and unique indicator IDs, also and especially for indicators that use the same common name.
This has already been implemented in ecRxiv, a GitHub-based publishing platform for ecosystem condition indicators [@Kolstad_ecRxiv].
On ecRxiv, indicator documentation follow a structured approach to both reporting and peer review (including code review).
Each indicator version is given its own ID, and its own fact sheet with a persistent URL, so that ECA that report these indicators unequivocally can cite specific indicator versions, and how they looked at a given point in time.
ecRxiv also includes standardised metadata reporting with fields, including ecosystem type (IUCN GET) and aggregation pathways (see recommendation number 1 above).

# References {.unnumbered}