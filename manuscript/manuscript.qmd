---
title: On the spatial aggregation of ecosystem condition indicators
author:
  - name: Anders Lorentzen Kolstad
    email: anders.kolstad@nina.no
    orchid: https://orcid.org/0000-0002-9623-9491
    affiliations: 
        - id: nina
          name: Norwegian Institute for Nature Research
          department: Department of Terrestrial Ecology
          address: Pb 5685 Torgarden
          city: Trondheim
          postal-code: 7485
    attributes:
        corresponding: true
  - name: Hanno Sandvik
    email: hanno.sandvik@nina.no
    orchid: https://orcid.org/0000-0002-5889-1606
    affiliations:
      - ref: nina
  - name: Bálint Czúcz
    email: balint.czucz@nina.no
    affiliations:
      - ref: nina
abstract: |
  Ecosystem condition assessments (ECA) and accounts use variables and indicators to describe key ecosystem characteristics reflecting the ecosystem condition and any potential deviations from a reference condition. These metrices are rutinely aggregation spatially to produce values representing the condition of a larger area, such as a country. However, we experience little awareness about the potential pitfals arising from aggregation bias of highly modified indicators. Here we outline some consequences regarding the order of the steps involed in normalising variables and aggregating them in space. We show that the choice of  aggregation pathways in non-trivial and has the potential to undermine the credibility and precition in ECAs, and to confuse the communication of their results. We introduce a common terminology for aggregation pathways, spesific to ecosystem condition indicators following SEEA EA standards, and make some recomendations about which pathway to use in different settings, and how to report these choices.   
  
keywords: 
  - SEEA EA
  - ecosystem condition
  - ecosystem accounting
  - indicators
  - aggregation bias
date: last-modified
bibliography: bibliography.bib
format:
  elsevier-pdf:
    keep-tex: true
    journal:
      name: ---
      formatting: preprint
      model: 3p
      cite-style: authoryear
    include-in-header:
      text: '\usepackage{lineno}\linenumbers'
execute:
  cache: true
  warning: false
  message: false
editor: 
  markdown: 
    wrap: sentence
---

# Introduction

Ecosystem accounting (EA), and other types of environmental assessments, are generally aimed at communicating major changes and trends in the extent and condition of ecosystems at a scale that is relevant for decision makers.
For ecosystem condition accounting (ECA) and assessments, this often requires that **metrics**[^1] used to describe the condition of ecosystems are aggregated spatially to produce a single value for a larger area.
This represents a type of knowledge synthesis, aimed at condensing the complexity of the real world into something actionable.
However, spatial aggregation can and will often change the interpretation of a metric and the descriptive properties and normative claims one can make based on it.
Without a good enough understand of the pitfalls in spatial aggregation of information, is can also lead to unintended and undetected systematic bias, as well as downright logical errors.
Although much attention has been devoted to the vertical aggregation of environmental indicators into indices (ref), as well as to the spatial aggregation of relatively unmodified or raw variables, there is to our knowledge no explicit deliberation on the special case of spatially aggregating highly modified indicators used for ecosystem condition accounting.
This paper therefore focus on explaining and providing guidelines on the spatial aggregation inherent to the System of Environmental Economic Accounting - Ecosystem Accounting (SEEA EA) - the most used ecosystem accounting (natural resource accounting) framework in the world (ref).
We pay specific attention to the phenomenon of aggregation bias introduce by @rastetter1992.

[^1]: Words in bold are explained in Table 1

### SEEA EA

SEEA EA includes principles for compiling accounts for ecosystem extent, ecosystem condition, and ecosystem services.
We will focus on the SEEA EA condition accounts in this paper.
In these accounts, information about ecosystem condition is made spatially explicit by assigning **variable** or **indicator** values to individual ecosystem assets.
Unless the underlying data are wall-to-wall maps, for example from satellite images, then this process of assigning values to ecosystem assets already here requires some spatial manipulations in the form of aggregation, dissaggregation, extrapolation or interpolation (ref Ewert 2011?), of which averaging or summing are the most common methods.
Subsequently, information from ecosystem assets may be spatially aggregated to larger areas, such as the entire ecosystem accounting area.
When EU and EEA countries are in 2026 required to report ecosystem condition accounts to Eurostat and the European Commision (?), these accounts will be spatially aggregated to national levels.
The point of having a robust methodological framework for the spatial aggregation of data and information is therefore quite pertinent.

### Indicators vs. variables

SEEA EA distinguishes between indicators and variables.
Variables in ecosystem condition terminology are metrics describing ecosystem characteristics [@unitednations2021].
They are typically either in units or percentages or fractions, or as raw biophysical units, such as biomass, density, or cover.
Indicators on the other hand, are always on a scale between 0 and 1, where 0 represent the worst condition, and 1 represents the best condition.
Sometimes indicators are calculated directly, but usually indicators are made by **normalising** variables based on two or more **reference levels**.
Although also variables may have normative properties (due to choices about how they are chosen (ref), defined, aggregated or presented) (Alain et al), the normalisation of variables into indicators makes indicators explicitly normative by introducing a clear directional interpretation, where increasing values always refer to an increase in condition.
The information held by the indicator is also different from that of the variable since additional ecological knowledge can be introduced via the reference levels.
The mathematical part of this normalisation contains two, sometimes three, steps [@fig-term].
These steps can be performed simultaneously, but for clarity we discuss them as separate steps.
The order of these steps can also change.

Variables can be **scaled** using a minimum of two reference levels, defining variable values to be coded as zero (X~0~) or one (X~100~) on the indicator scale.
Variables can be **truncated** to produce a bound indicator scale between 0 and 1.
Sometimes variables are **transformed** to adjust the indicator scale to reflect potentially nonlinear relationships between the variable and ecosystem condition.
This is commonly done by anchoring specific variable values to predefined class boundaries [@czúcz], but may also be done without any additional reference levels, for example by using a sigmoid or exponential transformation.

| Term             | Definition |
|------------------|------------|
| Metric           |            |
| Variable         |            |
| Indicator        |            |
| Reference levels |            |
| Scaling          |            |
| Transformation   |            |
| Truncation       |            |
| Normalisation    |            |
| Compensation     |            |
|                  |            |

: Definition of terms

# Why to we spatially aggregate data in ecosystem condition accounting

Spatiall aggregation of data refers to the conversion of fine-resolution data into coarser-resolution data, and depending on both the purpose and the nature of the metric, there can be several reasons both for performing and for refraining from spatial aggregation[@allain2018].
Generally, spatial aggregation increases the tangibility of a metric, because it simplifies or compresses the information, sometimes into just a single number (total aggregation).
This is sometimes necessary in ecosystem accounting when information is required at a relatively high administrative level (e.g. nations) and when variables and indicators need to be presented in standardised tables which dont allow for describing a lot of spatial variation.
Sometimes total aggregation of a variable or indicator is required for the metric to actually fit its purpose and become relevant to what it is designed to describe.
For example, a hypothetical metric "*proportion of total land area above critical nitrogen load",* informed from a spatial map of nitrogen loads, would only make sense if data was aggregated across some defined area.
The reason and need for aggregation may therefore originate in the original idea for the metric.
Data may also be only party aggregated, or the same metric may be presented at different levels of aggregation [@allain2018].

A minimum level of aggregation may be decided on based on the uncertainties in the data.
High spatially resolute data may be imprecise at fine scales, leading to false conclusion and potential miss-use [@lyytimäki2013], but these values seen over a larger area may be assumed to converge on some true value, making spatially aggregated data better suited for communication to users.
Other common arguments for performing spatial aggregation are to ease visualisation and to allow relevant comparisons [@allain2018].
For example, ecosystem condition metrics can be visualised on a map, but when both the the spatial resolution and spatial variation is high, maps become too complex, even unintelligible.
It is therefore common to partially aggregate the data and provide a coarser map where different colours, representing values on the map, become distinguishable from each other.
Similarly, one may chose to aggregate such that the spatial resolution matches some meaningful delineation, notably ecosystem assets in SEEA EA, which makes it possible to easily compare the aggregated values between these areas.

However, spatial aggregation can have several consequences that may or may not be desirable, such as smoothing out spatial variability, which can mask local patterns and trends.
This smoothing out makes the data and its inherent information less suitable for some uses, such as depicting spatial variation that can be used to support local land use planning, or for aiding a debate about spatial conflicts.

### Matching the scale of variables and reference levels {#sec-match}

Similar to variables, the reference levels used for normalising variables also have a spatial assignment, but it can be different from that of the variable.
For example, variable values may exist for unique 10 × 10 m grid cells, but the reference levels may be created with a different spatial scale in mind, for example municipalities, or they can be uniform across the entire accounting area (e.g. a natural zero).
Variables should not be normalised based on reference levels unless they are at a comparable scale.
Let's illustrate this with an example using a hypothetical variable depicting wild animal densities.
If the upper reference level (X~100~) for this variable is given by the assumed (or measured) animal densities under the **reference condition** (the optimal condition), then that reference level needs to be assigned a relevant spatial scale, for example a region where the densities are calculated over.
One will probably acknowledge the fact that animals move and distribute themselves non-randomly within these regions, and it therefore makes little sense to normalise the variable at a finer scale than region.
Doing so would mean that regions perfectly aligned with the reference condition (in terms of animal densities with the region) will show as having sub-regions with deteriorated condition simply due to natural variation in where the animals are at any give time.
In addition, averaging the indicator values across sub-regions would not produce a regional indicator value that represents its true situation as being perfectly aligned with the reference condition, since truncation ensures that variable values above X~100~ (assuming X~100~ \> X~0~) means we are only averaging the deviations from the reference level, and that very high animal densities in some sub-regions are not allowed to **compensate** for low values elsewhere.
This example with wild animal densities shows that sometimes variables need to be spatially aggregated before they can be normalised.

There are several requirements in the SEEA EA that make spatial aggregation necessary, but spatial aggregation also comes with a whole suite of (sometimes undesirable) side-effects.
Readers are referred to @allain2018 for a review of different reasons for spatially aggregating indicators.

```{r fig-term}
#| fig-cap: |
#|   Examples of how important terms are used in this manuscript. Note that the meaning of the terms may differ from how they are used in other fields, such as mathematics. The variable (1), in raw biophysical units, has a minimum and a maximum value (V), as well as points anchoring it to the indicator scale (X). Scaled variables (2) are scaled based on X~0~ and X~100~ only. Truncation (3) implies assigning the value of 0 to values below X~0~, and the value 1 to value above X~100~. Transformation refers to the non-linear transformation of values within the 0-1 range, as in this piecewise-linear example by mapping X~60~ to 0.6 on the indicator scale. Transformations without anchoring points are also included in this term, such as exponential or sigmoid transformation. Although both truncation and scaling can be seen as types of transformations, we exclude these methods from the definition here. Examples 2, 3, and 4 are normative (hence the gradient colour scale from red to green) because we assume they have declared that one end of the variable scale represents a good state and the other a poor state. All variables that are treated so that they conform to the definition of indicators in the SEEA EA are said to be normalised. For example, if a truncated variable is assumed to have a linear relationship with the indicator scale, then this variable has been normalised even though it has not been transformed. The term rescale is a synonym to normalise, but we will only use the latter from here on.
#| echo: false
knitr::include_graphics("../img/terminologi.png")
```

# Why do we normalise? {#sec-norm}

Normalisation of ecosystem condition indicators, as defined in @fig-term, serves multiple purposes.
Firstly, it gives a normative interpretation of a variable, defining a good and a bad state and a directionality to say when something is getting better or worse over time [@czucz_selection_2021].
SEEA EA encourages normalisation, but other environmental assessment framework leaves more of these kinds of value judgments to the end users (ref?).

Secondly, normalisation sets a limit to how much a high indicator value in one place can compensate for a low value somewhere else, and vice versa [@pedersen2016].
This is because truncation effectively means that when we spatially aggregate an indicator, we are always aggregating the negative deviation from the reference levels, and positive deviations (which could compensate for the negative ones) are ignored.
Transformation can sometimes also have this effect, e.g. sigmoid transformations.
One reason to want to aggregate the negative deviations only, is because the reference levels are set (or should be set) so that values above these limits do not represent any further increase (or decrease) in ecosystem condition (an exception if the WFD; see @sec-pti).
Therefore, this way of aggregation summarises the estimated ecosystem condition over an area (which is generally what we want), and not the variable itself.
In other words, normalising variables facilitate the spatial aggregation of our ecosystem condition estimates (i.e. the indicator values).

Thirdly, we normalise in order to standardise the indicator on the same scale so that we can perform thematic (i.e. vertical) aggregation (ref).
This is commonly referred to as *the* reason for normalising variables, but as we have shown, it is but one of three main reasons, and also perhaps the least confusing part for many.

```{r fig-agg1}
#| echo: false
#| fig-cap: |
#|   Example showing the difference in indicator values (y-axis) obtained from taking the mean of two variable values (V1 and V1) that are on the original scale (i hat) or on the normalised indicator scale (i bar). Due to truncation at x100, the latter results in a comparatively lower indicator value. The solid coloured line represents the normalisation function f(V). V = variable value, i = indicator value. Modified from Rastsetter (1991).
#| out-width: 400

knitr::include_graphics("../img/aggregation_bias_truncations.PNG")

```

```{r fig-agg2}
#| echo: false
#| fig-cap: |
#|   Same figure as above, but showing an example where the normalisation function includes a transformation step (see Figure 1 for definition) that anchors X60 to 0.6 on the indicator scale.
#| out-width: 400

knitr::include_graphics("../img/aggregation_bias_x60.PNG")
```

# Aggregation bias

The spatial aggregation of data can lead to biases arising from a number of sources.
For example, direct extrapolation based on uneven or spatially biased sampling leads to biased estimates [@kolstad_making_2024].
In this paper, however, we are mostly interested in what we consider an extended case of aggregation error, sensu @rastetter1992.
They showed that when we take the average of two variables, each of which have associated attribute values (e.g. indicator values), then the attribute of the average variable value differs from the average of the attributes of the original variables.
This displacement is refereed to as aggregation error, and its effect become more pronounced when the non-linearity is strong between variables and indicators.

## Aggregation error and discrepancies between variables and indicators

In ecosystem condition accounting the aggregation of both variables and indicators is common practice and raises the issue of **aggregation bias** (@fig-agg1; @fig-agg2) when variables have nonlinear relationships to the normalised indicators [@rastetter1992], which they typically do.
This means that the spatial aggregation of metrics leads to a divergence in the type of information held in variables and in their associated indicators, to a point where they become qualitatively very different.
As an example, consider an indicator based on spatial information on the abundance of a large herbivore.
The ecosystem characteristic that this metric is meant to describe is "*Appropriate herbivore pressure, balancing overgrazing and shrubification"*.
The variable shows relatively high densities in half the area and low densities in the other half.
When spatially aggregating the variable, either by taking the mean density or the sum of individuals, will produce an estimate that is somewhere in the middle of the two regions.
The user will have no information about the carrying capacity for each of the regions, and will only see the spatially aggregated value.
From this, many different conclusion can be made, depending on what the user consider high or low densities.
In any case, the judgment will not reflect a density that actually exists anywhere.
The indicator on the other hand, can have different reference levels for each region, introducing additional ecological information about the carrying capacity of the ecosystems.
The levels may be such that the high density region is considered as having an overabundance of herbivores, and the low density region as having underabundance.
When normalised, the indicator value will be low for both regions, and the spatially aggregated value will also be low.
The indicator will describe the average condition for the intended ecosystem characteristic, whereas the variable will in essence not show anything that can be interpreted as such.

The indicator arguably has much less room for miss-interpretation (relative to its intended use).
Although one common misunderstanding is that indicators named by an animal (e.g. reindeer) is taken by untrained users to represent a population status (typically the number of individuals).
This would, however, imply that the spatial aggregation function used for the indicator is summation, but the recommended, on assumed most used function, is an area weighted mean.
With this aggregation function, indicators will always refer to the mean indicator value for all the areas considered, and if properly defined, refer to the degree of fulfillment for the ecosystem characteristic.
Sometimes changing the indicator name, or redefining the indicator, goes a long way towards easing the interpretation and avoiding miss-use (e.g. *mean reindeer densities*).

Although the variable and the indicator may be reference by the same common name, and may be presented side-by-side, it is not so that they can replace each other or act as alternative evidence.
Presenting the same metric both in its indicator form and its variable form opens up for alternative interpretations.
While this may initially seem like a democratic and transparent approach to reporting, this practice actually places a significant burden on both the end user and the indicator developer.
The developer must clarify to the user how the two metrics have diverged significantly during spatial aggregation and normalisation, complicating the comparison of their respective information.
This can lead to miss-use, for example by taking the variable value and assigning it the same interpretation as the indicator value.

Generally, because of the normalisation process, indicators are more aligned with the purpose of ECA with describing ecosystem condition in normative terms.
Although variable accounts are allowed under the SEEA EA framework, they may be seen as a type of interim account for metrics that cannot or have not yet been normalised.
We would therefore argue that when an indicator has been developed, the original variable is not presented.
And when only variable estimates are given, extra care is give to describing the spatial aggregation pathway, and how this will have evened out any spatial variation that is relevant for interpreting the variable.

## Aggregation bias in indicator development

As we have seen, aggregation bias causes a divergence in the type of information made available through the spatial aggregation of variables versus indicators.
In addition, unavoidable aggregation bias (for good and bad) will also affect the indicator values and the inferences that can be drawn from these.
If not careful, aggregation bias may also cause errors to sneak into the indicator logic.
A major determinant of the resulting aggregation bias from the spatial aggregation of ecosystem condition indicators (@fig-agg1; @fig-agg2), is the choice about the order of the different steps in the normalisation and aggregation process, i.e. the aggregation pathway (@fig-pathways).
If normalisation occurs early in the aggregation process, the amount of compensation is limited.
However, sometimes complete or partial compensation is justified, as in the example in @sec-pti, or as we saw in @sec-match where indicator development involved an initial step of spatially aggregating variables to align with the spatial configuration of reference levels (pathways 2 and 3; @fig-pathways).
Failure to harmonise the spatial scale between variables and reference levels before normalising the variable can lead to aggregation bias, as described in @sec-bill.

Another cause of potential errors or confusion arising during the spatial aggregation of indicators, that may not relate directly to the aggregation bias problem, has to do with deciding on the appropriate area weights to use.
The SEEA EA uses a principle of commensurability, meaning that the order of certain operations should not affect the resulting estimate or value.
Spesifically, it should not matter whether you aggregated vertically first (to create an index) and then horizontally (i.e. spatial), or the other way around.
Note that this prisiple may not always hold for other cases, such as aggregating across nested areas, e.g. from ecosystem assets to EAAs, although this is commonly agreed upon as desirable.
This has to do with the for appropriate data to inform the area weighting in the spatial aggregation.
Consider an indicator originating from point-based field surveys.
The sampling location are selected using a stratified protocol that ensures a representative sample of similar size (same *n*) is made for each ecosystem asset.
If the variable is normalised early in the aggregation pathway to create indicator values for each locality, then the mean of indicator values for each region will be representative for those regions, and no area weighting is required.
For the next spatial level, when information from all ecosystem assets should be used to create an estimate for the EAA, ecosystem assets with large extents should weight more in the calculations (following the SEEA EA prinsiples of area weighting).
However, if in a later ECA, ecosystem assets are defined as subsets of the initial assets (a finer scale account), then the same indicator, when aggregated to the EAA level, will have a different value.
Cases when two accounts or assessments use what is considered the same indicator but find different values for the same areas, is cause for both confusion, and potentially mistrust.
(something here about indicator versions and good documentation)

## Aggregating to account for spatial autocorrelation 

# Indicator developer subjectivity

Indicator developer subjectivity is a big factor as the process of designing indicators and estimating indicator values often left entirely to the them, with little real involvement from indicator users.
It is therefore important to be aware of the role that indicator developers have in shaping the type of information, and the narratives, that is presented to decision makers.
This paper is aimed at providing some recommendations for how to choose the right spatial aggregation method for variables and indicators, and how to report these choices.
This will make it easier for indicator developers to avoid some of the pitfalls from having a too casual approach to the choice of aggregation pathways.

The choice of aggregation function (e.g. weighted arithmetic mean, worst-rule, or others) also influences the degree of compensation, i.e. the degree to which good condition in one place can compensate for bad condition somewhere else (ref WFD?).
Therefore, spatial aggregation can introduce substantial subjectivity from the side of the indicator developers, which also limits the different ways that a metric can be used and interpreted by indicator users (the target audience).
In other words, spatial aggregation tasks indicator developers with defining narratives for underlying variables, and it is therefor a normative and value-laden operation.

Something about sometimes spatial aggregation is an essential part of the indicator design ---

In the statistical standard for EAs and the recommended guidelines for ecosystem accounts [@unitednations2021; @unitednations2022], there is no mention of aggregation bias, and there seems to be little awareness in general of the ramification of choosing the wrong spatial aggregation method for variables.
Note that it is common in this field to use the term aggregation about the process of aggregating normalised indicators into indices (i.e. thematic or vertical aggregation; @langhans2014), but in this paper we are discussing spatial (i.e. horizontal) aggregation only.

# Aggregation pathways

We introduce the term aggregation pathway to describe the order of the steps used to go from a spatially explicit variable to a spatially aggregated metric, usually an indicator.
In @fig-pathways we show some aggregation pathways that we have come across, and some that we we see as potential new pathways.

Pathway 1 involves early normalisation suing the perhaps most common order of the three steps scaling, truncating and transforming.
The three steps may be done simultaneously as well.
Then the indicator is spatially aggregated.
Pathway 2 involves aggregating the variable before normalising.
Pathway 3 is similar, but here there are two aggregation steps: one before and one after normalisation.
This can for example be the case when variables are aggregated to the scale corresponding to the reference levels before they can be normalised.
Pathway 4 illustrated the aggregation of a variable, with no normalisation.
This is the pathway commonly used for variable accounts in the SEE EA. Pathway 5 is a common pathway in the WFD, which does not include spatial aggregation of indicator values.
Instead one report the number of water bodies in each condition class (spatial statistics).
Pathway 6 is a suggested pathway for handling WFD indicator in ECAs (see @sec-pti).

Pathways 7-8 describe the spatial aggregation of multiple indicators, as they all start with the normalisation step.
These are not the main topic of this paper, but are included here for completeness.
In pathway 7, indicators are thematically aggregated to an index, which is then again aggregated spatially.
In pathway 8, spatial aggregation is only done on individual indicators.
The two pathways differ in how they handle more complicated schemes for weighted averages, with pathway 8 being more flexible, but it may interfere with the principle of commutativity [@unitednations2021].

Pathway 9 describe how a single indicators is aggregated hierarchically from region to region, whereas pathway 10 shows a case were the aggregation process always starts from scratch for each hierarchical spatial level.
As for pathways 7 and 8, pathway 9 and 10 differ in how they propagate the indicator weight (typically area weight) between regions.

The choice about which pathway to use is not trivial, and in this paper we want to highlight some of the issues that could arise from having an *ad hoc* approach to these considerations.
Here we go through selected examples to illustrate some common pitfalls.

<!--# what we see as four general points that developers of ecosystem condition indicators and assessments should reflect upon carefully when deciding on an aggregation pathway for their indicator or their assessment. -->

## Wolves example {#sec-wolves}

*Variable*: Number of wolves en each carnivore management area (CMA).

*Reference:* X~0~ = is zero wolves present.
X~100~= Number of wolves equal to what experts think the ecosystem would support under the reference condition.
The reference levels are unique to each (CMA).

This example is from Norway, where wolves are extinct in most of the country.
Therefore, most carnivore management areas will get an indicator value of 0.
Wolves exists i designated wolf zones in south-east Norway, although in small numbers.
In the Norwegian Nature Index [@jakobsson2020], the variable follows pathway 1 and is normalised at the CMA level.
When aggregating the indicator to a national value, it is common for the general public to interpret this value as the status for wolves in Norway, and to connect this value to Norway's international obligations to maintain wolf numbers.
But note that even an unlimited number of wolves in the wolf zone would not to bring the national indicator value up to a level indicator good condition.
This is because the normalisation process truncates the variable, and does not allow overshooting values to compensate for lower values in the rest of the country.

\*Conclusion\*: Indicators should make intuitive sense to the readers.
However, there are sometimes good reasons for making things complicated.
In this example, The Norwegian Nature Index uses the same pathway for all indicators, so this common misunderstandings about what indicator values represents can be explain just one time, and not for each indicator specifically.
It can also be a good idea to sometime go back to the variable, and see if it can be defined differently to avoid these kinds of confusions.
Wolf numbers could in this example be converted to wolf density.

## Billberry example {#sec-bill}

This example illustrates a variable normalised at plot level or aggregated to regions first.
At what scale is the ref value intended?

<!-- Indicator: Blåbæredekning (billberry coverage) -->

<!-- Dataset: Norwegian national forest inventory. -->

<!-- Reference: https://www.naturindeks.no/Indicators/blaabaer -->

*Variable*: Horizontal coverage (vertical projection) of billberry (*Vaccinum myrtillus*) recorded in permanent vegetation plots.

*Reference levels*: X~100~ was defined for each of 5 regions in Norway based on an expert elicitation.
Experts were informed by the distribution of the variable values both within and outside protected areas, and the regional distribution of major forest types.
They also used their general knowledge about the effect of forestry and on the general vegetation structure of old-growth forests.

<!-- *Pathway*: 3 and 1 (on sperate occations) -->

The special thing about the billberry indicator is the different spatial resolution for the variable and for the reference level.
The variable is recorded at the scale of vegetation plots.
The reference level however, is designed with a regional spatial scale in mind, especially because of how it encompasses the known variation in forest types in a region to estimate the mean billberry coverage under the reference condition.
Because the normalisation includes a truncation step, scaling the variable at the plot scale (pathway 1; @fig-agg1) would not allow overshooting values to compensate for lower values when aggregating regional indicator values, which would then be negatively displaced ($\bar i$) relative to when aggregating variable values ($\hat i$; @fig-agg1).
Scaling at the plot scale would require require unique reference levels for each forest type.
However, both pathway 1 and 3 has been used for this variable in two different forest ecosystem condition assessments.
Due to non-negligeable truncation of the variable during the normalisation, the two indicators were subject to different levels of aggregation bias, and consequently the spatially aggregated indicator values for the two assessments became different.
This cause a general confusion about how how the same variable (and the same date) can produce different indicator values.

*Conclusion*: Given that the reference value is the way it is, this indicator should have followed pathway 3, and spatially aggregated the variable, from plot scale to regional scale, before normalising the variable and potentially aggregating it further.
It would also be possible to use pathway 6.

The wolves example also highlight the importance of making clear the differences in the interpretation of variables and indicators.
Often indicators and variables are both included side-by-side in ecosystem condition assessments/accounts.
This is also recommended practice following the SEEA EA. However, if the indicators that are presented are normalised before any spatial aggregation, then the interpretation of the indicators is not simply as a normalised version of the variable.
Indicators typically now reflect the average ecosystem condition, where areas in very good or very poor condition have limited ability to compensate for opposite extreme values elsewhere.
The spatially aggregated variable on the other hand, may reflect something like a sum of individuals, or some other aspect where values above and below the average value are able to compensate for each other.

## Alien species example {#sec-ali}

*Variable*: The local ecological effect from alien species (mostly vascular plants) recorded on a 7-step ordinal scale (1 = no alien species, 7 = only alien species).
The data comes from nature type monitoring with reference to individual occurrences (polygons).

*Reference levels*: X~0~ = total dominance from alien species (variable value 7).
X~100~ = zero influence from alien species (variable value 1).
X~60~ = \~2-5% alien plant cover (variable value 3).

<!-- *Pathway*: 1 -->

In this example, the reference levels are uniform throughout the EAA, and the normalisation includes a transformation in the form of a piecewise-linear transformation by anchoring X~60~ to 0.6 on the indicator scale.
When performing an ECA, one has the option to either aggregate variable value for each region (each ecosystem asset), and then normalise that value (pathway 2 and 3), or to normalise the variable at the scale of the original nature type polygons, and then aggregate the indicator values to the regional level (pathway 1).

*Conclusion*: One benefit of early normalisation is that two nested assessments, such as one national, and one assessment of region *Y* inside the same country, will get the same spatially aggregated value for region *Y*.
The other thing to ask oneself here is: *Why do we normalise* in the first place (@sec-norm)?
One reason is that we want to summarise information in space about the ecosystem condition.
It is the indicator values that hold this information, and not the variable.
We would therefore favor pathway 1 for this example.

Separate assessments should give identical indicator values for the same areas, given the same underlying data.
When this is not true it raises concerns about reproducibility and sacrifices the credibility of both assessments.
This was also the case in the billberry example, but here we used another example to illustrate the point further.

## Phytoplankton trophic index (PTI) {#sec-pti}

<!-- Dataset: “Vannmiljø”, the Norwegian Environment Agency’s database for Water Framework Directive relevant measurements -->

<!-- Reference: https://github.com/NINAnor/NI_vannf -->

*Variable*: Mean score of algal species present, based on a set of indicator species scored for phosphorus requirements/tolerance.
The variable is recorded in water bodies (lakes of 0,5 km\^2 or more).

*Reference levels*: X~100~ = median variable value for water bodies in reference condition.
X~0~, X~20~, X~40~, X~60~ and X~80~ = intercalibrated threshold values, based on dose–response curves.

<!-- Pathway: 1 -->

For use in water management, the Water Framework Directive (WFD) indicators uses aggregation pathway 7 [@fig-pathways], with truncation, scaling, and transformation.
The value obtained after the first two steps is called an EQR (ecological quality ratio), and the value obtained after the third step nEQR (normalised EQR).
Spatial aggregation is not done for the WFD, and therefore aggregation bias is not an issue.
When WFD data are put into use in other contexts, however, aggregation becomes important.
<!-- Relevant contexts in Norway are the Nature Index (ref) and ecological condition accounting. In both cases,  -->

*Conclusion*: Because of how X~100~ is defined based on the median value across reference lakes, overshooting values (\> X~100~) should be preserved in the spatial aggregation.
<!-- Otherwise, the condition of water bodies with X > X80 will be underreported.  --> Otherwise we get a negative displacement, as in the bilberry example.
This means that neither EQR values (which are untransformed), nor nEQR values (which are truncated), can be used uncritically in ECAs.
One solution, to enable the use of WFD indicators in ECA, would be to change to pathway 6, with (1) scaling, (2) transforming, (3) aggregating and (4) truncating the values [@fig-pathways].
Furthermore, Eurostat @eurostat2022\
<!-- requires  --> encourages reporting of variable values.
These, however, cannot be aggregated spatially in a meaningful way.
<!-- because the use of threshold values amounts to a nonlinear (specifically, a piecewise-linear) transformation.  -->

```{r fig-pathways}
#| fig-cap: |
#|   Flowchart showing pathways for the spatial aggregation of variables in ecosystem condition accounting. Normalisation refers to the steps that make a variable conform to the definition of an indicator in SEEA EA, which may or may not include the transformation step. A truncated and/or transformed variable will have a different interpretation than the original variable. The aggregation bias depends on whether variables are truncated and/or transformed variables before or after spatial aggregation. Variables are never normalised (pathway 4), and hence the aggregation bias for variables will be different than for indicators. An important factor influencing the the choice whether to normalise early (as in pathway 1), or later, is the spatial validity of the reference levels, and sometimes raw variable values (e.g. billberry coverage in vegetation quadrats) are spatially aggregated to the scale that was considered when setting the reference levels (e.g. average regional billberry coverage).
#| out-width: 400
#| echo: false
knitr::include_graphics("../img/aggregationPathways.jpg")
```

# Recommendation

Based on the example above, we suggest some recommendations for developers of ecosystem condition indicators and assessment for trying to avoid some of the pitfalls from having a too casual approach to the choice of aggregation pathways.

### 1. Report the aggregation pathway, using standardised terminology {.unnumbered}

In indicator documentation or ECA reports, authors should make an effort to make a precise description of the steps in the aggregation process.
To do this we suggest using the terms as described in @fig-term.
The description can be made even easier by referencing specific aggregation pathways in @fig-pathways by number.
Besides making the indicator workflow itself more transparent and reproducible, ee believe this recommendation would help raise the general awareness about aggregation bias in EAs, both among readers and researchers.
It will make the interpretation of assessment less prone to misunderstanding.
It will also make troubleshooting easier, as i the billberry example where researchers had to spend several days looking though old code to identify the reason why two assessment produces dissimilar indicator values from the same underlying data.

### 2. Normalise variables early, but at the scale where the reference levels are relevant {.unnumbered}

Normalising variables early in the aggregation pathway has several benefits, such as comparability between nested assessments (@sec-ali).
It also means that you are aggregating normative measures of condition, which is generally what you want in ECAs.
But same as variables and indicators, reference levels also have a spatial resolution, and they should only be used to normalise variables when the variable is at a scale which is relevant to the way the reference levels are defined.
This was exemplified with the billberry example (@sec-bill).

### 3. Use the same aggregation pathway for all indicators in the same assessment {.unnumbered}

It may be premature, or not even possible, to prescribe an aggregation pathway to be used for all ECAs, but internal consistency within assessments should be possible.
As we saw in the wolves example (@sec-wolves), this eases interpretation and reduces the chance that the meaning of indicators are misunderstood.

### 4. Use unique indicator IDs on indicators that are similar, but use different pathways {.unnumbered}

Indicators (and variables) often exist in multiple version, varying slightly in the raw data or in the methods used to produce the data or metrics.
Yet different versions are often refereed to by the same common name.
This causes confusion about which indicator version is being used, and thus making it difficult to make out which aggregation pathway that has been used.
We recommend making use of stable indicator IDs, unique for each version of the indicators sharing the same common name.
This has for example been implemented in [ecRxiv](https://github.com/NINAnor/ecRxiv), a publishing platform for ecosystem condition indicators.
 

# References {.unnumbered}