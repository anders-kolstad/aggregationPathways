---
title: On the spatial aggregation of ecosystem condition indicators
author:
  - name: Anders Lorentzen Kolstad
    email: anders.kolstad@nina.no
    orchid: https://orcid.org/0000-0002-9623-9491
    affiliations: 
        - id: nina
          name: Norwegian Institute for Nature Research
          department: Department of Terrestrial Ecology
          address: Pb 5685 Torgarden
          city: Trondheim
          postal-code: 7485
    attributes:
        corresponding: true
  - name: Hanno Sandvik
    email: hanno.sandvik@nina.no
    orchid: https://orcid.org/0000-0002-5889-1606
    affiliations:
      - ref: nina
  - name: Bálint Czúcz
    email: balint.czucz@nina.no
    affiliations:
      - ref: nina
abstract: |
  Ecosystem condition assessments (ECA) and accounts use variables and indicators to describe key ecosystem characteristics reflecting the ecosystem condition and any potential deviations from a reference condition. These metrices are rutinely aggregation spatially to produce values representing the condition of a larger area, such as a country. However, we experience little awareness about the potential pitfals arising from aggregation bias of highly modified indicators. Here we outline some consequences regarding the order of the steps involed in normalising variables and aggregating them in space. We show that the choice of  aggregation pathways in non-trivial and has the potential to undermine the credibility and precition in ECAs, and to confuse the communication of their results. We introduce a common terminology for aggregation pathways, spesific to ecosystem condition indicators following SEEA EA standards, and make some recomendations about which pathway to use in different settings, and how to report these choices.   
  
keywords: 
  - SEEA EA
  - ecosystem condition
  - ecosystem accounting
  - indicators
  - aggregation bias
  - upscaling
date: last-modified
bibliography: bibliography.bib
format:
  elsevier-pdf:
    keep-tex: true
    journal:
      name: ---
      formatting: preprint
      model: 3p
      cite-style: authoryear
    include-in-header:
      text: '\usepackage{lineno}\linenumbers'
execute:
  cache: true
  warning: false
  message: false
editor: 
  markdown: 
    wrap: sentence
callout-appearance: simple
callout-icon: false
---

# Introduction

The world is facing a nature crisis of a magnitude that requires urgent political decision making and international coordination.
Ecosystem accounting (EA) is a type of environmental assessments aimed at communicating on the status and trends in the extent and condition of ecosystems at a scale that is relevant for decision makers.
For ecosystem condition accounting (ECA) and assessments, this often requires that metrics[^1] used to describe the condition of ecosystems are aggregated spatially, sometimes to produce a single value for a larger area.
This represents a type of knowledge synthesis, aimed at condensing the complexity of the real world into something that is relevant to decision makers and perhaps actionable at a political level.
However, spatial aggregation affect how a metric should be interpreted, and the descriptive properties and normative claims one can make based on it.
Without an understanding of the pitfalls during spatial aggregation of information, one risks introducing unintended and undetected systematic bias, as well as downright logical errors, into the decition making process.

[^1]: We use the SEEA EA definitions of the terms variables, indicators (normalised variables) and metrics (refering to either a variable or a metric) [@unitednations2024]

Although much attention has been devoted to the vertical aggregation of environmental indicators into indices (e.g. @langhans2014; @maes2020; @oecd_2008\], as well as to the spatial aggregation of relatively unmodified or raw variables (e.g @allain2018) , there is to our knowledge no explicit deliberation on the special case of spatially aggregating highly modified indicators used for ecosystem condition accounting (but see @vanbeurden1999).
This paper therefore focus on explaining and providing guidelines on the spatial aggregation inherent to the System of Environmental Economic Accounting - Ecosystem Accounting (SEEA EA) [@unitednations2024] - the most used ecosystem accounting framework in the world [@comte2022].

SEEA EA includes principles for compiling accounts for ecosystem extent, ecosystem condition, and ecosystem services [@unitednations2024 @unitednations2022].
We will focus on the SEEA EA condition accounts in this paper, although spatial aggregation is a relevant topic also for the other parts of the account.
When EU and EEA countries are in 2026 required to report ecosystem condition accounts to Eurostat and the European Commision (?), these accounts will be spatially aggregated to national levels, thus invoking the issue of the ecological fallacy (Box 1), and many other potential pitfalls in the spatial aggregation of information.
The point of having a robust methodological framework for the spatial aggregation of data and information is therefore quite pertinent.

This paper is aimed primarily at indicator developers, providing them with some recommendations for how to choose the right spatial aggregation method for variables and indicators, and how to report these choices.
Indicator developer subjectivity affects ECAs, in part because the process of designing indicators and estimating indicator values often left entirely to the them, with little real involvement from indicator users.
It is therefore important to be aware of the role that indicator developers have in shaping the type of information, and the narratives, that is presented to decision makers.
This paper will make it easier for indicator developers to avoid some of the pitfalls from having a too casual approach to the choice of aggregation pathways.

## Terminology

There is a jungle of terms used for similar metrics or operations across relevant theoretical frameworks for ecosystem assessments, such as the SEEA EA, WFD, MSFD, IBECA, OSPAR, PAEC, HD, CFP, and others.
We see a need to a common, more standardised terminology across these fields of practice in order to ease communication and avoid misunderstandings.
For now we will now define the terms and how we use them in this paper.

SEEA EA distinguishes between indicators and variables, as do we.
Variables are metrics describing ecosystem characteristics [@unitednations2024 §5.41].
They are typically either in percentages or fractions, or as raw biophysical units, such as biomass, density, or cover.
Indicators on the other hand, are always on a unitless scale between 0 and 1, where 0 represent the worst condition, and 1 represents the best condition.
Sometimes indicators are calculated directly, but usually indicators are made by normalising variables based on two or more reference levels [@unitednations2024 §5.60].
Although also variables may have normative properties (due to choices about how they are chosen, defined, aggregated or presented [@allain2018]), the normalisation of variables into indicators makes them explicitly normative by introducing a clear directional interpretation, where increasing values always refer to an increase in condition in the direction of a reference condition.
The information held by the indicator is also different from that of the variable since additional ecological knowledge can be introduced via the reference levels.
The mathematical part of this normalisation contains several steps [@fig-term].
These can be performed simultaneously, but for clarity we discuss them as separate steps.
The order of the steps can also change.

Variables can be scaled using a minimum of two reference levels that defines which variable values to be coded as zero (X~0~) and as one (X~100~) on the indicator scale.
Variables can be truncated to produce a bound indicator scale between 0 and 1.
Sometimes variables are transformed to adjust the indicator scale to reflect potentially nonlinear relationships between the variable and ecosystem condition.
This is commonly done by anchoring specific variable values to predefined class boundaries [@czúcz; @jakobsson_setting_2020], but may also be done without any additional reference levels, for example by using a sigmoid or exponential transformation.
Finally, the indicator scale can also be divided into discrete fractions, either based on additional reference levels, or some other rule (e.g. equal range for each class).
We refer to this step as categorisation.

```{r fig-term}
#| fig-cap: |
#|   Examples of how important terms are used in this manuscript. Note that the meaning of the terms may differ from how they are used in other fields, such as mathematics. The variable (1), in raw biophysical units, has a minimum and a maximum value (V), as well as points anchoring it to the indicator scale (reference levels; X). Scaled variables (2) are scaled based on X~0~ and X~100~ only. Truncation (3) implies assigning the value of 0 to values below X~0~, and the value 1 to value above X~100~. Transformation (4) refers to the non-linear transformation of values within the 0-1 range, as in this piecewise-linear example by mapping X~60~ to 0.6 on the indicator scale. Transformations without anchoring points are also included in this term, such as exponential or sigmoid transformation. Categorisation (5) refers to the creation of discrete bins (here five) where incremental change in uncategorised indicator values within a set of class boundaries is ignored. Although truncation, scaling and categorisation can be seen as types of transformations, we exclude these methods from the definition here. Examples 2-5 are normative (hence the gradient colour scale from red to green) because we assume it has been  declared that one end of the scale represents a good state and the other a poor state. All variables that are treated so that they conform to the definition of indicators in the SEEA EA are said to be normalised. For example, if a truncated variable is assumed to have a linear relationship with the indicator scale, then this variable has been normalised even though it has not been transformed. The term rescale is a synonym to normalise, but we will only use the latter from here on.
#| echo: false
knitr::include_graphics("../img/terminologi.png")
```

# Why do we spatially aggregate data in ecosystem condition accounting

Spatiall aggregation of data refers to the conversion of fine-resolution data into coarser-resolution data, and depending on both the purpose and the nature of the metric, there can be several reasons both for performing and for refraining from spatial aggregation.
Readers are referred to @allain2018 for a more comprehensive review of different reasons for spatially aggregating variables.
As we shall see, there are several requirements in the SEEA EA that make spatial aggregation necessary.
However, spatial aggregation also comes with a whole suite of (sometimes undesirable) side-effects.

Generally, spatial aggregation increases the tangibility of a metric, because it simplifies or compresses the information, sometimes into just a single number (total aggregation).
This is sometimes necessary in ecosystem accounting when information is required at a relatively high administrative level (e.g. nations) and when variables and indicators need to be presented in standardised tables which don't allow for describing a lot of spatial variation.

Sometimes total aggregation of a metric is required for the it to actually fit its purpose and become relevant to what it is designed to describe.
For example, a hypothetical variable "*proportion of total land area above critical nitrogen load",* informed from a spatial map of nitrogen loads, would only make sense if data was aggregated across some defined area.
The reason and need for aggregation may therefore originate in the original idea for the metric.

Data may also be only party aggregated, or the same metric may be presented at different levels of aggregation [@allain2018].
A minimum level of aggregation may be decided based on uncertainties in the data: High spatially resolute data may be imprecise at fine scales, leading to false conclusion and potential miss-use [@lyytimäki2013], but these values seen over a larger area may be assumed to converge on some true value, making spatially aggregated data better suited for communication to users.
Other common arguments for performing spatial aggregation are to ease visualisation and to allow relevant comparisons [@allain2018].
For example, ecosystem condition metrics can be visualised on a map, but when both the the spatial resolution and spatial variation is high, maps become too complex, even unintelligible.
It is therefore common to partially aggregate the data and provide a coarser map where different colours, representing values on the map, become distinguishable from each other.
Similarly, one may chose to aggregate such that the spatial resolution matches some meaningful delineation, notably ecosystem assets in SEEA EA, which makes it possible to easily compare the aggregated values between these areas.

Spatial aggregation can have several consequences that may or may not be desirable, such as smoothing out spatial variability, which can mask local patterns and trends.
This smoothing out makes the data and its inherent information less suitable for some use cases, such as depicting spatial variation that can be used to support local land use planning, or for aiding a debate about spatial conflicts or identification of high risk areas.

Spatial aggregating of ecosystem condition metrics is applied to alleviate issues of spatial auto-correlation.
For example if data is collected opportunistically with sampling sizes varying between areas, then performing partial spatial aggregation to some intermediate sized areas will give equal weight or importance to all areas regardless of how many data points are included in each.
This approach represents a form of post-stratification.

Interpolation, or other types of modeling, can also be used to impute or predict data values between the points where we have information [@finke2002; @stein2001].
This approach can also be seen as a type of post-stratifiction, and it can result in better variable or indicator estimates for the ecosystem assets as a whole.
It can also be motivated by a desire to know more about the fine-scale variation in variable value, and perhaps visualise this on a map.
This type of spatial aggregation, or perhaps better named upscaling, is not the focus of this paper (but see @nte-rel), and in our experience this has not been common practice in SEEA EA accounts produced to date.

## Matching the scale of variables and reference levels {#sec-match}

Similar to variables, the reference levels used for normalising variables also have a spatial assignment, which can be different from that of the variable.
For example, variable values may exist for unique 10 × 10 m grid cells, but the reference levels may be created with a different spatial scale in mind, for example municipalities, or they can be uniform across the entire accounting area (e.g. a natural zero).
Variables should not be normalised based on reference levels unless they are at a commensurable spatial scale.
Let's illustrate this with an example using a hypothetical variable depicting wild animal densities.
If the upper reference level (X~100~) for this variable is given by the assumed (or measured) animal densities under the reference condition, then that reference level needs to be assigned a relevant spatial scale, for example a region where the densities are calculated over.
One will probably acknowledge the fact that animals move and distribute themselves non-randomly within these regions, and it therefore makes little sense to normalise the variable at a finer scale than region.
Doing so would mean that regions perfectly aligned with the reference condition (in terms of animal densities with the region) will show as having sub-regions with sub-optimal condition, simply due to natural variation in where the animals are at any give time.
Averaging (arguably the most common spatial aggregation function) the indicator values across sub-regions would not produce a regional indicator value that shows the region as being perfectly aligned with the reference condition, since truncation of variable values above X~100~ (assuming X~100~ \> X~0~) means we are only aggregating the negative deviations from the reference level, and that very high animal densities in some sub-regions are not allowed to compensate for low values elsewhere.
This example with wild animal densities shows that sometimes variables need to be spatially aggregated before they can be normalised.
See Example 1 for another example.

::: callout-note
**Example 1 -- Billberry**\

*Variable*: Horizontal coverage (vertical projection) of billberry (*Vaccinum myrtillus*) recorded in permanent vegetation plots.\

*Reference levels*: X~100~ was defined for each of 5 regions in Norway based on an expert elicitation.
Experts were informed by the distribution of the variable values both within and outside protected areas, and the regional distribution of major forest types.
They also used their general knowledge about the effect of forestry and on the general vegetation structure of old-growth forests.\

The billberry indicator exemplifies different spatial resolutions for the variable and for the reference levels.
The variable is recorded at the scale of vegetation plots.
The reference level however, is designed with a regional spatial scale in mind, especially because of how it encompasses the known variation in forest types in a region to estimate the mean billberry coverage under the reference condition.
Because the normalisation includes a truncation step, normalisation the variable at the plot scale (pathway 1; @fig-agg1) would not allow overshooting values to compensate for lower values when aggregating regional indicator values, which would then be negatively displaced ($\bar i$) relative to when aggregating variable values ($\hat i$; @fig-agg1).\
<!-- Scaling at the plot scale would require unique reference levels for each forest type. However, both pathway 1 and 3 has been used for this variable in two different forest ecosystem condition assessments.
Due to non-negligeable truncation of the variable during the normalisation, the two indicators were subject to different levels of aggregation bias, and consequently the spatially aggregated indicator values for the two assessments became different.
This caused a general confusion about how how the same variable (and the same data) can produce different indicator values. -->

*Conclusion*: Given that the reference value is the way it is, this indicator should have followed pathway 3 (@fig-agg1), and spatially aggregated the variable from plot scale to regional scale before normalising the variable and potentially aggregating it further.
:::

## Fitting data to ecosystem assets

In SEEA EA, information about ecosystem condition is made spatially explicit by assigning variable or indicator values to ecosystem assets.
This process requires some spatial manipulations of data, or scale changes [@ewert2011].
The type of manipulation depends on the spatial resolution of the underlying data, as well as the size and configuration of the ecosystem assets.
Two main types of data can be distinguished: sparse (i.e. spatially incomplete) data and complete data.

<!--# Subsequently, spatial aggregation is required when going from ecosystem assets to large spatial scale, ultimately the scale of the entire ecosystem accounting area (EAA).  -->

Complete, or wall-to-wall data, include remote sensing products, but also other types of pre-aggregated data, where sparse data are assigned to areal units.
This last type of data is very common.
A lot of demographic information for example is made available at the scale of administrative units, rather than at the individual level (which would be very ineffective and problematic also in terms of protecting sensitive information).
Similar pre-aggregation is, however, ambiguous and true for most complete datasets.
Consider as an example data from LiDAR (Light Detection And Ranging).
The raw data is a point cloud, yet the most commonly available datasets are rasters, such as surface or canopy models; wall-to-wall generalisations of the point cloud.
Also data such as satellite images ,or maps derived from such, have some inherent pre-aggregation where values are averaged for each raster cell.
Often there is little we can do, as indicator developers, to affect this pre-aggregation step, but it is important to be aware of it in light of the ecological fallacy (Box 1).
This issue will for example affect our ability to detect true maximum or minimum values (used in *worst case* aggregation, for example in the WFD) for the phenomena our variable is describing, since these extremes are already smoothed out in the pre-aggregation step.
This will clearly affect the suitability of such data for identifying areas of high risk (very degraded areas, for example).
The problem is the same when we deliberately aggregate data later in the indicator development process, and we always need to ensure that the spatial aggregation function we use does not have any unintentional effect on the type of inference that we can draw from the metric.

For sparse data we are considering data where variable values are assigned to singular points or small areas.
In these cases, there will be a lot of area inside each ecosystem asset for which we have no direct information.
To assign variable value to all areas (as is required in the SEEA EA framework), we need to do some generalisations.
One can assign values to areas via an aggregation functions used on data values that fall within a given ecosystem asset.
Many aggregation functions are available, such as sum, worst-rule, different percentiles, arithmetic, geometric or harmonic means[^2] [@unitednations2024 §5.54] .
When doing this aggregation, we need to account for the spatial structure (spatial correlations) of the data.
One way is to rely on design-based approaches (relying on random or balanced samples across the entire EEA), or using a step-wise aggregation via ecosystem assets.
In our experience, the choice of which area units to use when doing this step-wise aggregation is often not reflected much upon.
In some cases the areal units are even decided politically, for example to administrative units, with little ecological justification for this choice.
However, this decision clearly affects the results of the spatial aggregation via a well-described (but often forgotten?) statistical problem referred to at the modifiable area unit problem (MAUP; Box 1).
It is important for decision makers to see that the information they are basing their decision on is robust and insensitive to aggregation methods [@vanbeurden1999].
The MAUP can, however, lead to inconsistencies between repeated or nested ECAs, leading to confusion and mistrust (@sec-comp).
One option to reduce this discrepancy and arbitrariness is to use ecologically motivated areal units in the step-wise aggregation such as homogeneous ecosystem areas [@vallecillo2022] or homogeneous impact areas [@kolstad_making_2024].

[^2]: When using means across areas, area weighting is required when following SEEA EA.

::: callout-note
**Box 1 -- Related concepts**\

**Vertical aggregation**

It is common in this field to use the term aggregation about the process of aggregating normalised indicators into indices (i.e. thematic or vertical aggregation; @langhans2014), but in this paper we are discussing spatial (i.e. horizontal) aggregation only.

**Upscaling**

The term spatial aggregation is also sometimes used to refer to **upscaling** in the sense of taking local information and making it applicable or translate it to larger, e.g. landscape or regional, scales [@knotters2010; @finke2002].
This process often involves predicting values across larger areas or surfaces, generally through models, including krieging-based models and distribution models.
When the data (e.g. indicator values) are made wall-to-wall, one can then more easily get point estimates for larger areas via simple aggregation functions such as summation or by taking the mean.
Using models to predict variable or indicator values is allowed under the SEEA EA. However, in this paper we are addressing the second part of this process only, of simplifying the spatial variation, from many to few data points (sometimes also included in the terms upscaling).

**Modifiable area unit problem**

The modifiable area unit problem (MAUP; [@openshaw1984, @wong2009]) describes the sensitivity that spatially aggregated information has on the choice about the spatial units used for either collecting the data or for aggregating the data to.
These units can be arbitrary (*modifiable*), yet different sizes and configuration of units can have large effects on the outcome of aggregation.
Administrative units are often used as the ecosystem assets in SEEA EAs, yet they are in an ecological sense almost always arbitrary, and can also be subject to change over time.
The original spatial units that data are collected at may be a pragmatic choice in much the same way.
Further still, data may not be available at the original spatial scale, but may only be downloadable in preaggregated form [@vanbeurden1999].
All these cases lead to some form of aggregation bias [@rastetter1992] where the aggregated information has a non-linear relationship with the true variable value.
However, the issue of MAUP in SEEA EA deserves an in-depth analyses that we cannot provide here.

**Ecological fallacy**

The ecological fallacy [@robinson2009] explains the common misinterpretation of correlations between group (*i.e.* aggregated information) and some phenomena.
Simply said, the mean of a group, or an area, cannot accurately describe the qualities of individuals in that group, or pin-points inside that area, yet it is common for people to interpret it that way.
:::

# Why do we normalise variables? {#sec-norm}

Normalisation of ecosystem condition indicators, as defined in @fig-term, serves multiple purposes.
Firstly, it gives a normative interpretation of a variable, defining a good and a bad state and a directionality to say when something is getting better or worse over time [@czucz_selection_2021].
SEEA EA encourages normalisation (which they refer to as rescaling), but other environmental assessment or natural resource accounting frameworks, refrains from these kinds of value judgments, or leaves more of this task up to the end users (ref?).

Secondly, normalisation sets a limit to how much a high variable value in one place can compensate for a low value somewhere else, and vice versa [@pedersen2016].
This is because truncation effectively means that when we spatially aggregate an indicator, we are always aggregating the negative deviations from the upper reference level X~100~, and ignoring any positive deviations which would otherwise compensate for the negative ones (see example in @sec-match).
Transformation can sometimes also have this effect, e.g. sigmoid transformations.
One reason to want to aggregate the negative deviations only, is because the reference levels are set (or should be set) so that values above these limits do not represent any further increase (or decrease) in ecosystem condition (an exception if the WFD; see @sec-pti).
Therefore, this way of aggregation summarises the estimated ecosystem condition over an area (which is generally what we want), and not the variable itself.
In other words, normalising variables facilitate the spatial aggregation of our ecosystem condition estimates (i.e. the indicator values).
The flip-side of this is that spatially aggregating variable values does not directly summarise information about ecosystem condition for that area.

Thirdly, we normalise in order to standardise the indicator on the same scale so that we can perform thematic (i.e. vertical) aggregation [@jakobsson2021; @unitednations2024 §5.81].
This is commonly referred to as *the* reason for normalising variables, but as we have shown, it is but one of three main reasons, and also perhaps the least confusing part for many.

```{r fig-agg1}
#| echo: false
#| fig-cap: |
#|   Examples showing the difference in indicator values (y-axis) obtained from taking the mean of two variable values (V1 and V1) that are on the original scale (i hat) or on the normalised indicator scale (i bar). Pane A: Due to truncation at X~100~, the latter results in a comparatively lower indicator value. Pane B: Example where the normalisation function includes a transformation step (see Figure 1 for definition) that anchors X~60~ to 0.6 on the indicator scale. This reverses the order of i hat and i bar compared to example in pane A. The solid coloured line represents the normalisation function f(V). V = variable value, i = indicator value. Modified from Rastsetter (1991).
#| out-width: 600

knitr::include_graphics("../img/aggregation_bias.PNG")

```

# Aggregation bias

The spatial aggregation of data can lead to biases arising from a number of sources.
For example, direct extrapolation based on uneven or spatially biased sampling leads to biased estimates [@kolstad_making_2024].
We will, however, focus now on what we consider an extended case of aggregation error, sensu @rastetter1992.
They showed that when we take the average of two variables, each of which have associated attribute values (e.g. indicator values), then the attribute of the average variable value differs from the average of the attributes of the original variables.
This displacement is refereed to as aggregation error, and its effect become more pronounced when the non-linearity is strong between variables and indicators.
In the statistical standard for EAs and the recommended guidelines for ecosystem accounts [@unitednations2024; @unitednations2022], there is no mention of aggregation bias, and there seems to be little awareness in general of the ramification of choosing the wrong spatial aggregation method for variables.
We now describe two ways that aggregation bias affects ECAs: by causing an increasing divergence in the type of information held in ecosystem condition variables versus indicators, and secondly, how it can cause confusion about the effects of chosing different aggregation pathways (see @sec-pathways) during indicator development.

## Discrepancies between variables and indicators

In ecosystem condition accounting the aggregation of both variables and indicators is common practice and raises the issue of aggregation bias (@fig-agg1) when variables have nonlinear relationships to the normalised indicators [@rastetter1992], which they typically do.
This means that the spatial aggregation of metrics leads to a divergence in the type of information held in variables and in their associated indicators, to a point where they become qualitatively very different.
As an example, consider an indicator based on spatial information on the abundance of a large herbivore.
The ecosystem characteristic that this metric is meant to describe is "*Appropriate herbivore pressure, balancing overgrazing and shrubification"*.
Imagine the variable shows relatively high densities in half the area and low densities in the other half.
When spatially aggregating the variable, either by taking the mean density or the sum of individuals, will produce an estimate that is somewhere in the middle of the two regions.
The user will have no information about the carrying capacity for each of the regions, and will only see the spatially aggregated value.
From this, many different conclusion can be made, depending on what the user consider high or low densities.
In any case, the judgment will not reflect a density that actually exists anywhere.
The indicator on the other hand, can have different reference levels for each region, introducing additional ecological information about the carrying capacity of the ecosystems.
The levels may be such that the high density region is considered as having an overabundance of herbivores, and the low density region as having underabundance.
When normalised, the indicator value will be low for both regions, and the spatially aggregated value will also be low.
The indicator will describe the average condition for the intended ecosystem characteristic, whereas the variable will in essence not show anything that can be interpreted as such.

The wolves example (Example 2) also highlight the importance of making clear the differences in the interpretation of variables and indicators.
Indicators and variables are sometimes presented side-by-side in ecosystem condition assessments or accounts.
This is also recommended practice following the SEEA EA [@unitednations2024; ch. 5.3.4].
However, due to aggregation bias, spatially aggregated indicators should not be interpreted as normalised versions of aggregated variables.
Aggregated indicators reflect the average ecosystem condition, where areas in very good or very poor condition have limited ability to compensate for opposite extreme values elsewhere.
The spatially aggregated variable on the other hand, may reflect something like a sum of individuals, an average of a population, or some other aspect where values above and below the reference levels are able to compensate for each other.

Aggregated variables and the associated aggregated indicators cannot act as alternative evidence or interpretations for the state of nature.
While this may initially seem like a democratic and transparent approach to reporting, this practice places a significant burden on both the end user and the indicator developer.
Miss-use can ensue, for example by taking the variable value and assigning it the same interpretation as the indicator value.
t the very least, the developer must clarify to the user how the two metrics have diverged significantly during spatial aggregation and normalisation, complicating the comparison of their respective information.

::: callout-note
**Example 2 -- Wolves**\

*Variable*: Number of wolves en each carnivore management area (CMA).\

*Reference levels:*   X~0~ = zero wolves present.\
X~100~= Number of wolves equal to what experts think the ecosystem would support under the reference condition.
The reference levels are unique to each (CMA).\

This example is from Norway, where wolves are extinct in most of the country.
Therefore, most carnivore management areas will get an indicator value of 0.
Wolves exist in designated wolf zones in south-east Norway, although in small numbers.
In the Norwegian Nature Index [@jakobsson2020], the variable follows pathway 1 and is normalised at the CMA level.
When aggregating the indicator to a national value, it is common for the general public to interpret this value as the status for wolves in Norway, and to connect this value to Norway's international obligations to maintain wolf numbers.
But note that even an unlimited number of wolves inside the wolf zones would not to bring the national indicator value up to a very hight level.
This is because the normalisation process truncates the variable, and does not allow overshooting values to compensate for lower values in the rest of the country.
The Norwegian Nature Index uses (approximately) the same pathway for all indicators, so this common misunderstandings about what indicator values represents can be explaind just one time, and not for each indicator specifically.\

```{=html}
<!-- \*Conclusion\*: Indicators should make intuitive sense to the readers.
However, there are sometimes good reasons for making things complicated. -->
```

It can, however, be a good idea to sometimes go back to the variable, and see if it can be defined differently to avoid these kinds of confusions.
Wolf numbers could in this example be converted to wolf density.
:::

```{=html}
<!-- The indicator arguably has much less room for miss-interpretation (relative to its intended use).
Although one common misunderstanding is that indicators named by an animal (e.g. wolves; Example 2) is taken by untrained users to represent a population status (typically the number of individuals).
This would, however, imply that the spatial aggregation function used for the indicator is summation, 
but the recommended, on arguably the most used function, is an area weighted mean.
With this aggregation function, indicators will always refer to the mean indicator value for all the areas considered, and if properly defined, refer to the degree of fulfillment for the ecosystem characteristic.
Sometimes changing the indicator name, or redefining the indicator, goes a long way towards easing the interpretation and avoiding miss-use (e.g. *mean reindeer densities*). -->
```

Generally, because of the normalisation process, indicators are more aligned with the purpose of ECA with describing ecosystem condition in normative terms.
Although variable accounts are allowed under the SEEA EA framework, ans is indeed a central feature, we belive they should be seen as interim accounts for metrics that cannot or have not yet been normalised.
We would therefore argue that when an indicator has been developed, the original variable is not presented.
And when only variable estimates are given, extra care is given to describing the spatial aggregation pathway.

## Aggregation bias in indicator development

As we have seen, aggregation bias causes a divergence in the type of information made available through the spatial aggregation of variables versus indicators.
In addition, unavoidable aggregation bias (for good and bad) will also affect the indicator values and the inferences that can be drawn from these.
If not careful, aggregation bias may also cause errors to sneak into the indicator logic.
A major determinant of the resulting aggregation bias from the spatial aggregation of ecosystem condition indicators (@fig-agg1), is the choice about the order of the different steps in the normalisation and aggregation process, i.e. the aggregation pathway (@fig-pathways).
If normalisation occurs early in the aggregation process, the amount of compensation, or off-setting, is limited.
However, sometimes complete or partial compensation is justified.
In @sec-match we saw how indicator development involved an initial step of spatially aggregating variables to align with the spatial configuration of reference levels (pathways 2 and 3; @fig-pathways).
In Example 3 we see that compensation can be warranted, depending on how high the reference levels are set.

::: callout-note
**Example 3 -- Phytoplankton trophic index (PTI)**\

<!-- Dataset: “Vannmiljø”, the Norwegian Environment Agency’s database for Water Framework Directive relevant measurements -->

<!-- Reference: https://github.com/NINAnor/NI_vannf -->

*Variable*: Mean score of algal species present, based on a set of indicator species scored for phosphorus requirements/tolerance.
The variable is recorded in water bodies (lakes of 0,5 km\^2 or more).
 

*Reference levels*: X~100~ = median variable value for water bodies in reference condition.
X~0~, X~20~, X~40~, X~60~ and X~80~ = intercalibrated threshold values, based on dose–response curves.\

<!-- Pathway: 1 -->

The Water Framework Directive (WFD) indicators uses aggregation pathway 7 [@fig-pathways], with truncation, scaling, and transformation, in that order.
The value obtained after the first two steps is called an EQR (ecological quality ratio), and the value obtained after the third step nEQR (normalised EQR).
Spatial aggregation, the way that we use the term here, is not done for the WFD.
Instead, the proportion of water bodies in each condition class is the aggregated reporting metric.
Therefore aggregation bias is not an issue.
When WFD data are put into use in other contexts, however, aggregation becomes important.\
<!-- Relevant contexts in Norway are the Nature Index (ref) and ecological condition accounting. In both cases,  -->

*Conclusion*: Because of how X~100~ is defined based on the median value across reference lakes, overshooting values (\> X~100~) should be preserved in the spatial aggregation.
<!-- Otherwise, the condition of water bodies with X > X80 will be underreported.  --> Otherwise we get a negative displacement, making it practically impossible to reach an indicator value of 1.

This means that neither EQR values, nor nEQR values, can be uncritically aggregated spatially to be sued in a SEEA EA comlient in ECA.
One solution, to enable the use of WFD indicators in ECAs, would be to change to pathway 6, with (1) scaling, (2) transforming, (3) aggregating and (4) truncating the values [@fig-pathways].\

Furthermore, Eurostat [@eurostat2022] <!-- requires  --> encourages reporting of variable values.
These, however, cannot be aggregated spatially in any meaningful way for WFD indicators.
The issue is the same as for all other variables for which normalised indicators exist, but is perhaps more extreme for WFD indicators due to different reference conditions and levels for different water body types, and strong non-linear transformation functions that inflate the aggreation bias issuse.
<!-- Can we have a figure of calculation exmaple here? -->
:::

# Aggreements across nested ECAs {#sec-comp}

We do not presume that ECA end users will have the capacity, nor interest, to refect very much upon the effect that spatial aggregation has had on the properties of the information they are presneted with.
It should simply work, without the need for elaborate explenations.
Cases when two accounts or assessments use what is considered the same indicator but find different values for the same areas, is cause for both confusion, and potentially mistrust.
This can, however, happen, and has happened, when nested ECA use different aggregation pathways for the same indicator, for example when nested assessments use a different number of aggregation levels.

Consider a case ECA was to be made for a country.
For one of the varaibles, data sampling was random and dispersed across the EAA, and a national indicator values was calculated as some average across all sampling points.
Then in a later regional ECA, the same indicator was estimated for separate regions, as well as for the whole country.
When aggregating the indicator values from regions to the whole country, using area weighting, the national estimate will differ, albeit slightly, from the initial national estimate that did not include this step-wise aggregation, causing potentially the two nested assessment to reach different conclusions.
A third account, focusing on municipalities (using municipalities as ecosystem assets, rather than the larger regions), will create a third answer to the same question.
We believe it a very desirable property of ECA to be compliant and harmonised assessment scales.
In this spesific case, one could in the first national account have performed a step-wise aggregtion via municipalities, regions, and finally to the wntire EAA, but it would not always be possibel to know which ecosystem assest are to be used in future accounts.
We belive one solution to this is to aqknowledge that the aggregation pathway, including the number of aggregation levels used, can affect the indicators so much, sometimes as much as variation in the variable itself, that the use of different pathways imply that metrics are named and treated uniquely, for example using different common names, but perhaps better still, different version numbers or indicator IDs.
Fr each unique indicator the precise aggregation pathway should be specified as part of the indicator metadata.
This would show ECA users if two accounts are using different metrics that cannot be assumed to behave similarly or report the same thing, even if they have the same common name and data source.

Besides changing the number of aggregation levels, the choice about when in the aggregation pathway to normalise variables is a possible factor leading to discrepancies across nested accounts (Example 4).

```{=html}
<!-- The SEEA EA uses a principle of commensurability, meaning that the order of certain operations should not affect the resulting estimate or value.
Spesifically, it should not matter whether you aggregated vertically first (to create an index) and then horizontally (i.e. spatial), or the other way around.
Note that this prisiple may not always hold for other cases, such as aggregating across nested areas, e.g. from ecosystem assets to EAAs, although this is perhaps considered desirable.
This has to do with the use of area weighting in the spatial aggregation. -->
```

```{=html}
<!-- 
Consider an indicator originating from point-based field surveys.
The sampling location are selected using a stratified protocol that ensures a representative sample of similar size (same *n*) is made for each ecosystem asset.
If the variable is normalised early in the aggregation pathway to create indicator values for each locality, then the mean of indicator values for each region will be representative for those regions, and no area weighting is required.
For the next spatial level, when information from all ecosystem assets should be used to create an estimate for the EAA, ecosystem assets with large extents should weight more in the calculations (following the SEEA EA prinsiples of area weighting).
Note that one cannot skip this first level of spatial aggregation via ecosystem assets, since this is an integral part of the sampling design, leading to spatial autocorrelation.
However, if in a later ECA, ecosystem assets are defined differently, e.g. as subsets of the initial assets (a finer scale account), 
then the same indicator, when aggregated to the EAA level, will have a different value. -->
```

```{=html}
<!-- In our experience this can also lead to time consuming detective work, trying to find the causes for such discrepancies.
We suggest two immediate solution to this issue.
First, to find better ways to document the aggregation pathways that are being used for each indicator, as part of the indicator metadata.
Second, to find ways to distinguish between apparently identical indicators, for example using different version numbers or IDs.
We provide practical solution to both these suggestions in @sec-rec. -->
```

::: callout-note
**Example 3 -- Alien species**\

*Variable*: The local ecological effect from alien species (mostly vascular plants) recorded on a 7-step ordinal scale (1 = no alien species, 7 = only alien species).
The data comes from nature type monitoring with reference to individual occurrences (polygons).\

*Reference levels*: X~0~ = total dominance from alien species (variable value 7).
X~100~ = zero influence from alien species (variable value 1).
X~60~ = \~2-5% alien plant cover (variable value 3).\

<!-- *Pathway*: 1 -->

In this example, the reference levels are uniform throughout the EAA, and the normalisation includes a transformation in the form of a piecewise-linear transformation by anchoring X~60~ to 0.6 on the indicator scale (similar to @fig-agg1 pane B, but without truncation, as that is not needed in the alien species example).
When performing an ECA, one has the option to either aggregate variable values for each ecosystem asset, and then normalise that value (pathway 2 and 3), or to normalise the variable at the scale of the original nature type polygons (Basal spatial unit (BSU) scale), and then aggregate the indicator values to the regional level (pathway 1).
Arguably the variable and the reference levels are at commensurable scales in both cases (cf. Example 1), and other arguments for choosing one over the other must be found.\

One benefit of early normalisation is that two nested assessments, such as one national, and one assessment of region *Y* inside the same country, will get the same spatially aggregated value for region *Y*.
Separate assessments should give identical indicator values for the same areas, given the same underlying data.
When this is not true it raises concerns about reproducibility and sacrifices the credibility of both assessments.
The other thing to ask oneself here is: *Why do we normalise* in the first place (@sec-norm)?
One reason is that we want to summarise information in space about the ecosystem condition.
It is the indicator values that hold this information, and not the variable.
We would therefore favor pathway 1 for this example.
:::

# Aggregation pathways {#sec-pathways}

We introduce the term aggregation pathway to describe the order of the steps used to go from a spatially explicit variable to a spatially aggregated metric, usually an indicator.
In @fig-pathways we show some aggregation pathways that we have come across, and some that we we see as potential new pathways.
The choice about which pathway to use is not trivial, and we want to highlight some of the issues that could arise from having an *ad hoc* approach to these considerations.

Pathway 1 involves early normalisation using the perhaps most common order of the three steps scaling, truncating and transforming.
The three steps may be done simultaneously or in sequence.
Finanlly, the indicator is spatially aggregated.

Pathway 2 involves aggregating the variable before normalising.
This preserves the ability for very high or very low variable values to compensate for very low or very high values elsewhere, respectively.

Pathway 3 is similar, but here there are two aggregation steps: one before and one after normalisation.
This can for example be the case when variables are aggregated to the scale corresponding to the reference levels before they can be normalised (Example 1).

Pathway 4 illustrates the aggregation of a variable, with no normalisation.
This is the pathway commonly used for variable accounts in the SEE EA. For this, and all other aggregation pathways, the picture can be made more complicated by adding additional aggregation levels (i.e. a step-wise aggregation, @sec-comp)

Pathway 5 is a common pathway in the WFD, which does not include spatial aggregation of indicator values.
Instead one report the number of water bodies in each condition class (spatial statistics).
Pathway 6 is a suggested pathway for handling WFD indicator in ECAs (see Example 3), where truncation is postponed until after the spatial aggregation for in that way to allow overshooting values to compensate for low indicator values esewhere (what we refer to as compensation).

Pathways 7-8 describe the spatial aggregation of composite indicators (indices).
These are not the main topic of this paper, but are included here for completeness.
In pathway 7, indicators are thematically aggregated to an index, which is then again aggregated spatially.
In pathway 8, spatial aggregation is only done on individual indicators.
The two pathways differ in how they handle more complicated schemes for weighted averages.
The spatial aggregation of indices (pathway 7), using area weighted means, does not allow different area weights to be applied to each underlying indicator.
Yet this would in many cases be needed if the individual indicators do not all represents the entire ecosystem inside each ecosystem asset.
This is often the case, since ECA are frequently geared towards high level ecosystem types (e.g. level 2 in the IUCN GET [@keith_iucn_2020]) that includes several lower level ecosystems that may need unique indicators to describe them.
Pathway 8 is therefore more flexible in this regard, but it may interfere with the principle of commutativity [@unitednations2024].
We feel this is a very much unresolved issue in the SEEA EA.

Pathway 9 describe how a single indicators can be aggregated hierarchically from region to region, whereas pathway 10 shows a case were the aggregation process always starts from scratch for each hierarchical spatial level.
As for pathways 7 and 8, pathway 9 and 10 differ in how they propagate the indicator weight (typically area weight) between regions.
SEEA EA describes and prescribes a hierarchical spatial aggregation (pathway 9).
Note that can cause issues with comparability across nested assessment, if one alters the number or size of sub-regions (@sec-comp).

```{r fig-pathways}
#| fig-cap: |
#|   Flowchart showing pathways for the spatial aggregation of variables in ecosystem condition accounting. Normalisation refers to the steps that make a variable conform to the definition of an indicator in SEEA EA, which may include some, but not necesarily all the steps scale, truncate and transform.
#| out-width: 400
#| echo: false
knitr::include_graphics("../img/aggregationPathways.jpg")
```

# Recommendation {#sec-rec}

Based on the example above, we suggest some recommendations for developers of ecosystem condition indicators and assessment for trying to avoid some of the pitfalls from having a too casual approach to the choice of aggregation pathways.

### 1. Report the aggregation pathway, using standardised terminology {.unnumbered}

In indicator documentation or ECA reports, authors should make an effort to make a precise description of the steps in the aggregation process.
To do this we suggest using the terms as described in @fig-term.
The description can be made even easier by referencing specific aggregation pathways in @fig-pathways by number.
Besides making the indicator workflow itself more transparent and reproducible, ee believe this recommendation would help raise the general awareness about aggregation bias in EAs, both among readers and researchers.
It will make the interpretation of assessment less prone to misunderstanding.
It will also make troubleshooting easier, as i the billberry example where researchers had to spend several days looking though old code to identify the reason why two assessment produces dissimilar indicator values from the same underlying data.

### 2. Normalise variables early, but at the scale where the reference levels are relevant {.unnumbered}

Normalising variables early in the aggregation pathway has several benefits, such as comparability between nested assessments (@sec-ali).
It also means that you are aggregating normative measures of condition, which is generally what you want in ECAs.
But same as variables and indicators, reference levels also have a spatial resolution, and they should only be used to normalise variables when the variable is at a scale which is relevant to the way the reference levels are defined.
This was exemplified with the billberry example (@sec-bill).

### 3. Use the same aggregation pathway for all indicators in the same assessment {.unnumbered}

It may be premature, or not even possible, to prescribe an aggregation pathway to be used for all ECAs, but internal consistency within assessments should be possible.
As we saw in the wolves example (@sec-wolves), this eases interpretation and reduces the chance that the meaning of indicators are misunderstood.

### 4. Use unique indicator IDs on indicators that are similar, but use different pathways {.unnumbered}

Indicators (and variables) often exist in multiple version, varying slightly in the raw data or in the methods used to produce the data or metrics.
Yet different versions are often refereed to by the same common name.
This causes confusion about which indicator version is being used, and thus making it difficult to make out which aggregation pathway that has been used.
We recommend making use of stable indicator IDs, unique for each version of the indicators sharing the same common name.
This has for example been implemented in [ecRxiv](https://github.com/NINAnor/ecRxiv), a publishing platform for ecosystem condition indicators.
 

# References {.unnumbered}